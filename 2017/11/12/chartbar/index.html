<!doctype html>
<html lang="zh-CN">









<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <!-- ä¼˜å…ˆä½¿ç”¨ IE æœ€æ–°ç‰ˆæœ¬å’Œ Chrome -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <!-- ä¸ºç§»åŠ¨è®¾å¤‡æ·»åŠ  viewport -->
  <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <!-- æ·»åŠ åˆ°ä¸»å±åçš„æ ‡é¢˜ï¼ˆiOS 6 æ–°å¢ï¼‰ -->
  <meta name="apple-mobile-web-app-title" content="canvaså›¾è¡¨(1) - æŸ±çŠ¶å›¾ - Jeff's world">
  <!-- æ˜¯å¦å¯ç”¨ WebApp å…¨å±æ¨¡å¼ï¼Œåˆ é™¤è‹¹æœé»˜è®¤çš„å·¥å…·æ å’Œèœå•æ  -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <!-- è®¾ç½®è‹¹æœå·¥å…·æ é¢œè‰² -->
  <meta name="apple-mobile-web-app-status-bar-style" content = "black" />
  <!-- æ·»åŠ æ™ºèƒ½ App å¹¿å‘Šæ¡ Smart App Bannerï¼ˆiOS 6+ Safariï¼‰ -->
  <!-- <meta name = "apple-itunes-app" content = "app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"> -->
  <!-- å¿½ç•¥é¡µé¢ä¸­çš„æ•°å­—è¯†åˆ«ä¸ºç”µè¯ï¼Œå¿½ç•¥emailè¯†åˆ« -->
  <meta name="format-detection" content = "telphone=no, email=no" />
  <!--ä¸‹é¢ä¸‰ä¸ªæ˜¯æ¸…é™¤ç¼“å­˜ å¾®ä¿¡æµè§ˆå™¨ç¼“å­˜ä¸¥é‡åˆæ— åˆ·æ–°ï¼›è¿™ä¸ªæ–¹æ³•è°ƒè¯•çš„æ—¶å€™å¾ˆæ–¹ä¾¿-->
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <link rel="dns-prefetch" href="https://jeff_zhong.gitee.io/blog">
  <link rel="icon shortcut" type="image/ico" href="/favicon.ico">
  <meta name="author" content="Jeff Zhong">
  <meta name="description" content="it's a blog by hexo">
  <meta name="keywords" content="hexo theme">
  <title >canvaså›¾è¡¨(1) - æŸ±çŠ¶å›¾ - Jeff's world</title>
    <!-- The Open Graph protocol -->
  <meta property="og:url" content="https://jeff_zhong.gitee.io/blog">
  <meta property="og:type" content="blog">
  <meta property="og:title" content="canvaså›¾è¡¨(1) - æŸ±çŠ¶å›¾ - Jeff's world">
  <meta property="og:description" content="it's a blog by hexo">
  
    
    
      <link rel="stylesheet" href="/blog/lib/fontello/fontello.css">
    
      <link rel="stylesheet" href="/blog/lib/reboto/roboto.css">
    
      <link rel="stylesheet" href="/blog/css/index.css">
    
  
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5255e97b442092b8e1a219e6a48a0d42";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/blog/atom.xml" title="Jeff's world" type="application/atom+xml">
</head>
<body>
<header class="header">
  <div class="top"></div>
  <h2>Jeff's World</h2>
  <h3>Things that I'm interested in</h3>
  <div class="menu">
  
  
  
      <a  href="/blog/" title="ä¸» é¡µ">
        <i class="icon-home"></i>
        <span>ä¸» é¡µ</span>
      </a>
  
      <a  href="https://jeff_zhong.gitee.io/demo/" title="Demo">
        <i class="icon-page"></i>
        <span>Demo</span>
      </a>
  
      <a  data-tag="search"  href="javascript:;" title="æœ ç´¢">
        <i class="icon-search"></i>
        <span>æœ ç´¢</span>
      </a>
  
  </div>
  <div class="state">
  
    <a href="/blog/archives">48<br>æ–‡ ç« </a><a href="/blog/categories">2<br>åˆ† ç±»</a><a href="/blog/tags">64<br>æ ‡ ç­¾</a>
  </div>
  <div class="social">
  
  
  
      <a href="https://github.com/edwardzhong" target="_blank" rel="noopener" title="Github"><i class="icon-github"></i></a>
  
      <a href="https://twitter.com/JianfengEdward" target="_blank" rel="noopener" title="Twitter"><i class="icon-twitter"></i></a>
  
      <a href="https://www.facebook.com/jianfeng.edward" target="_blank" rel="noopener" title="Facebook"><i class="icon-facebook"></i></a>
  
      <a href="http://weibo.com/1593251850" target="_blank" rel="noopener" title="Weibo"><i class="icon-weibo"></i></a>
  
      <a href="/blog/atom.xml" title="Rss"><i class="icon-rss"></i></a>
  
  </div>
  <div id="payBtn" class="pay-icon" title="è°¢è°¢æ‚¨çš„èµèµ">èµ</div>
</header>
  <div class="container">
    <div class="main">
    
        
<div class="post-list">
	<article class="post" style="animation:listshow 0.6s ease-out both 0.30000000000000004s">
    
    
        
    
	
	<a href="javascript:;">
        <div class="post-banner" style="background: url(/images/banner2.jpg)  center top / 100% no-repeat">
    		<h3 class="post-title">canvaså›¾è¡¨(1) - æŸ±çŠ¶å›¾</h3>
    	</div>
	</a>
	<div class="post-inner">
	
    	<div class="post-info">
    		<time><i class="icon-calendar"></i> 2017/11/12 18:45:00</time>
    		<span class="category">
    		
    			
    			<i class="icon-book"></i>
    			
                    
                        <a href="/blog/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
                    
    			
    		
    		</span>
    	</div>
    	<!-- <p><p>å‰å‡ å¤©ç”¨åˆ°äº†å›¾è¡¨åº“ï¼Œå…¶ä¸­ç™¾åº¦çš„EChartsï¼Œæ„Ÿè§‰åšå¾—æœ€å¥½ï¼Œçœ‹å®ƒé»˜è®¤ç”¨çš„æ˜¯canvasï¼Œcanvaså›¾è¡¨åœ¨å¤„ç†å¤§æ•°æ®æ–¹é¢æ¯”svgè¦å¥½ã€‚é‚£æˆ‘ä¹Ÿç”¨canvasæ¥å®ç°ä¸€ä¸ªå›¾è¡¨åº“å§ï¼Œæ„Ÿè§‰ä¸ä¼šå¤ªéš¾ï¼Œå…ˆå®â€¦</p>
</p> -->
    	
    		<div class="post-content"><!-- åŸæ–‡åœ°å€ï¼š[canvaså›¾è¡¨(1) - æŸ±çŠ¶å›¾](https://jeff_zhong.gitee.io/blog/2017/11/12/chartbar/) -->
<p>å‰å‡ å¤©ç”¨åˆ°äº†å›¾è¡¨åº“ï¼Œå…¶ä¸­ç™¾åº¦çš„EChartsï¼Œæ„Ÿè§‰åšå¾—æœ€å¥½ï¼Œçœ‹å®ƒé»˜è®¤ç”¨çš„æ˜¯canvasï¼Œcanvaså›¾è¡¨åœ¨å¤„ç†å¤§æ•°æ®æ–¹é¢æ¯”svgè¦å¥½ã€‚é‚£æˆ‘ä¹Ÿç”¨canvasæ¥å®ç°ä¸€ä¸ªå›¾è¡¨åº“å§ï¼Œæ„Ÿè§‰ä¸ä¼šå¤ªéš¾ï¼Œå…ˆå®ç°ä¸ªç®€å•çš„æŸ±çŠ¶å›¾ã€‚</p>
<p>æ•ˆæœè¯·çœ‹ï¼š<em><a href="https://jeff_zhong.gitee.io/demo/dist/chartbar.html">æŸ±çŠ¶å›¾https://jeff_zhong.gitee.io/demo/dist/chartbar.html</a></em></p>
<!-- ![it](http://oncse3u6r.bkt.clouddn.com/chartchartbar.jpg) -->
<img src="/images/charbar.jpg" width="400">
<a id="more"></a>

<p>ä¸»è¦åŠŸèƒ½ç‚¹åŒ…æ‹¬ï¼š</p>
<ol>
<li>æ–‡æœ¬çš„ç»˜åˆ¶</li>
<li>XYè½´çš„ç»˜åˆ¶ï¼›</li>
<li>æ•°æ®åˆ†ç»„ç»˜åˆ¶ï¼›</li>
<li>æ•°æ®åŠ¨ç”»çš„å®ç°ï¼›</li>
<li>é¼ æ ‡äº‹ä»¶çš„å¤„ç†ã€‚</li>
</ol>
<h2 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ä½¿ç”¨æ–¹å¼ï¼Œå‚è€ƒäº†éƒ¨åˆ†EChartsçš„ä½¿ç”¨æ–¹å¼ï¼Œå…ˆä¼ å…¥è¦æ˜¾ç¤ºå›¾è¡¨çš„htmlæ ‡ç­¾ï¼Œæ¥ç€è°ƒç”¨initï¼Œåˆå§‹åŒ–çš„åŒæ—¶ä¼ å…¥æ•°æ®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> con=<span class="built_in">document</span>.getElementById(<span class="string">'container'</span>);</span><br><span class="line"><span class="keyword">var</span> chart=<span class="keyword">new</span> Bar(con);</span><br><span class="line">chart.init(&#123;</span><br><span class="line">  title:<span class="string">'å…¨å¹´é™é›¨é‡æŸ±çŠ¶å›¾'</span>,</span><br><span class="line">  xAxis:&#123;<span class="comment">// xè½´</span></span><br><span class="line">    data:[<span class="string">'1æœˆ'</span>,<span class="string">'2æœˆ'</span>,<span class="string">'3æœˆ'</span>,<span class="string">'4æœˆ'</span>,<span class="string">'5æœˆ'</span>,<span class="string">'6æœˆ'</span>,<span class="string">'7æœˆ'</span>,<span class="string">'8æœˆ'</span>,<span class="string">'9æœˆ'</span>,<span class="string">'10æœˆ'</span>,<span class="string">'11æœˆ'</span>,<span class="string">'12æœˆ'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  yAxis:&#123;<span class="comment">//yè½´</span></span><br><span class="line">    name:<span class="string">'æ°´é‡'</span>,</span><br><span class="line">    formatter:<span class="string">'&#123;value&#125; ml'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  series:[<span class="comment">//åˆ†ç»„æ•°æ®</span></span><br><span class="line">    &#123;</span><br><span class="line">      name:<span class="string">'ä¸œéƒ¨é™æ°´é‡'</span>,</span><br><span class="line">      data:[<span class="number">62</span>,<span class="number">20</span>,<span class="number">17</span>,<span class="number">45</span>,<span class="number">100</span>,<span class="number">56</span>,<span class="number">19</span>,<span class="number">38</span>,<span class="number">50</span>,<span class="number">120</span>,<span class="number">56</span>,<span class="number">130</span>]	</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      name:<span class="string">'è¥¿éƒ¨é™æ°´é‡'</span>,</span><br><span class="line">      data:[<span class="number">52</span>,<span class="number">10</span>,<span class="number">17</span>,<span class="number">25</span>,<span class="number">60</span>,<span class="number">39</span>,<span class="number">19</span>,<span class="number">48</span>,<span class="number">70</span>,<span class="number">30</span>,<span class="number">56</span>,<span class="number">8</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      name:<span class="string">'å—éƒ¨é™æ°´é‡'</span>,</span><br><span class="line">      data:[<span class="number">12</span>,<span class="number">10</span>,<span class="number">17</span>,<span class="number">25</span>,<span class="number">27</span>,<span class="number">39</span>,<span class="number">50</span>,<span class="number">38</span>,<span class="number">100</span>,<span class="number">30</span>,<span class="number">56</span>,<span class="number">90</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      color:<span class="string">'hsla(270,80%,60%,1)'</span>,</span><br><span class="line">      name:<span class="string">'åŒ—éƒ¨é™æ°´é‡'</span>,</span><br><span class="line">      data:[<span class="number">12</span>,<span class="number">30</span>,<span class="number">17</span>,<span class="number">25</span>,<span class="number">7</span>,<span class="number">39</span>,<span class="number">49</span>,<span class="number">38</span>,<span class="number">60</span>,<span class="number">30</span>,<span class="number">56</span>,<span class="number">10</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å›¾è¡¨åŸºç±»ï¼Œæˆ‘ä»¬åé¢è¿˜è¦å†™é¥¼å›¾ï¼ŒæŠ˜çº¿å›¾ï¼Œæ‰€ä»¥æŠŠå…¬å…±çš„éƒ¨åˆ†æŠ½å‡ºæ¥ã€‚æ³¨æ„canvas.style.widthä¸canvas.widthæ˜¯ä¸ä¸€æ ·çš„ï¼Œå‰è€…ä¼šæ‹‰ä¼¸å›¾å½¢ï¼Œåè€…æ‰æ˜¯æˆ‘ä»¬æ­£å¸¸ç”¨çš„ï¼Œä¸ä¼šæ‹‰ä¼¸å›¾å½¢ã€‚åœ¨è¿™é‡Œè¿™æ ·å†™å…ˆæ‰©å¤§å†ç¼©å°æ˜¯ä¸ºäº†è§£å†³canvasç»˜åˆ¶æ–‡å­—æ—¶æ¨¡ç³Šçš„é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chart</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(container)&#123;</span><br><span class="line">    <span class="keyword">this</span>.container=container;</span><br><span class="line">    <span class="keyword">this</span>.canvas=<span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</span><br><span class="line">    <span class="keyword">this</span>.ctx=<span class="keyword">this</span>.canvas.getContext(<span class="string">'2d'</span>);</span><br><span class="line">    <span class="keyword">this</span>.W=<span class="number">1000</span>*<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">this</span>.H=<span class="number">600</span>*<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">this</span>.padding=<span class="number">120</span>;</span><br><span class="line">    <span class="keyword">this</span>.paddingTop=<span class="number">50</span>;</span><br><span class="line">    <span class="keyword">this</span>.title=<span class="string">''</span>;</span><br><span class="line">    <span class="keyword">this</span>.legend=[];</span><br><span class="line">    <span class="keyword">this</span>.series=[];</span><br><span class="line">    <span class="comment">//é€šè¿‡ç¼©å°ä¸€å€ï¼Œè§£å†³å­—ä½“æ¨¡ç³Šé—®é¢˜</span></span><br><span class="line">    <span class="keyword">this</span>.canvas.width=<span class="keyword">this</span>.W;</span><br><span class="line">    <span class="keyword">this</span>.canvas.height=<span class="keyword">this</span>.H;</span><br><span class="line">    <span class="keyword">this</span>.canvas.style.width = <span class="keyword">this</span>.W/<span class="number">2</span> + <span class="string">'px'</span>;</span><br><span class="line">    <span class="keyword">this</span>.canvas.style.height = <span class="keyword">this</span>.H/<span class="number">2</span> + <span class="string">'px'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ±çŠ¶å›¾åˆå§‹åŒ–ï¼Œè°ƒç”¨es6ä¸­çš„Object.assign(this,opt)ï¼Œè¿™ä¸ªç›¸å½“äºJQä¸­çš„extendæ–¹æ³•ï¼ŒæŠŠå±æ€§å¤åˆ¶åˆ°å½“å‰å®ä¾‹ã€‚åŒæ—¶è¿˜å»ºäº†ä¸ªtipå±æ€§ï¼Œè¿™æ˜¯ä¸ªhtmlæ ‡ç­¾ï¼Œåé¢æ˜¾ç¤ºæ•°æ®ä¿¡æ¯ç”¨ã€‚æ¥ç€ç»˜åˆ¶å›¾å½¢ï¼Œç„¶åç»‘å®šé¼ æ ‡äº‹ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span> <span class="keyword">extends</span> <span class="title">Chart</span></span>&#123;</span><br><span class="line">	<span class="keyword">constructor</span>(container)&#123;</span><br><span class="line">		<span class="keyword">super</span>(container);</span><br><span class="line">		<span class="keyword">this</span>.xAxis=&#123;&#125;;</span><br><span class="line">		<span class="keyword">this</span>.yAxis=[];</span><br><span class="line">		<span class="keyword">this</span>.animateArr=[];</span><br><span class="line">	&#125;</span><br><span class="line">	init(opt)&#123;</span><br><span class="line">		<span class="built_in">Object</span>.assign(<span class="keyword">this</span>,opt);</span><br><span class="line">		<span class="keyword">if</span>(!<span class="keyword">this</span>.container)<span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">this</span>.container.style.position=<span class="string">'relative'</span>;</span><br><span class="line">		<span class="keyword">this</span>.tip=<span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">		<span class="keyword">this</span>.tip.style.cssText=<span class="string">'display: none; position: absolute; opacity: 0.5; background: #000; color: #fff; border-radius: 5px; padding: 5px; font-size: 8px; z-index: 99;'</span>;</span><br><span class="line">		<span class="keyword">this</span>.container.appendChild(<span class="keyword">this</span>.canvas);</span><br><span class="line">		<span class="keyword">this</span>.container.appendChild(<span class="keyword">this</span>.tip);</span><br><span class="line">		<span class="keyword">this</span>.draw();</span><br><span class="line">		<span class="keyword">this</span>.bindEvent();</span><br><span class="line">	&#125;</span><br><span class="line">	draw()&#123;<span class="comment">//ç»˜åˆ¶</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	showInfo()&#123;<span class="comment">//æ˜¾ç¤ºä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	animate()&#123;<span class="comment">//æ‰§è¡ŒåŠ¨ç”»</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	showData()&#123;<span class="comment">//æ˜¾ç¤ºæ•°æ®</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç»˜åˆ¶XYè½´"><a href="#ç»˜åˆ¶XYè½´" class="headerlink" title="ç»˜åˆ¶XYè½´"></a>ç»˜åˆ¶XYè½´</h2><p>é¦–å…ˆç»˜åˆ¶æ ‡é¢˜ï¼Œæ¥ç€XYè½´ï¼Œç„¶åéå†åˆ†ç»„æ•°æ®seriesï¼Œé‡Œé¢æœ‰å¤æ‚çš„è®¡ç®—ï¼Œç„¶åç»˜åˆ¶XYè½´çš„åˆ»åº¦ï¼Œç»˜åˆ¶åˆ†ç»„æ ‡ç­¾ï¼Œæœ€åæ˜¯ç»˜åˆ¶æ•°æ®ã€‚æ•°æ®é¡¹seriesä¸­æ˜¯åˆ†ç»„æ•°æ®ï¼Œå®ƒè·ŸXè½´çš„xAxis.dataä¸€ä¸€å¯¹åº”ã€‚æ¯ä¸ªé¡¹å¯ä»¥è‡ªå®šä¹‰åç§°å’Œé¢œè‰²ï¼Œæ²¡æœ‰æŒ‡å®šçš„è¯ï¼Œåç§°èµ‹äºˆnunamedå’Œè‡ªåŠ¨ç”Ÿæˆé¢œè‰²ã€‚è¿™é‡Œè¿˜ç”¨legendå±æ€§è®°å½•ä¸‹äº†æ ‡ç­¾åˆ—è¡¨ä¿¡æ¯ï¼Œå› ä¸ºåç»­é¼ æ ‡ç‚¹å‡»åˆ¤æ–­æ˜¯å¦ç‚¹ä¸­ç”¨çš„ä¸Šã€‚<br>canvasä¸»è¦çŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li>åˆ†ç»„æ ‡ç­¾ä½¿ç”¨äº†arcToæ–¹æ³•ï¼Œè¿™æ ·å°±èƒ½ç»˜åˆ¶å‡ºåœ†è§’çš„æ•ˆæœã€‚</li>
<li>ç»˜åˆ¶æ–‡æœ¬ä½¿ç”¨äº†measureTextæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥æµ‹é‡æ–‡å­—æ‰€å å®½åº¦ï¼Œè¿™æ ·å°±å¯ä»¥è°ƒæ•´ä¸‹ä¸€æ¬¡ç»˜åˆ¶çš„ä½ç½®ï¼Œé¿å…ä½ç½®å†²çªã€‚</li>
<li>translateä½ç§»æ–¹æ³•ï¼Œå¯ä»¥æ”¾åœ¨ç»˜åˆ¶ä¸Šä¸‹æ–‡(saveå’Œrestoreçš„ä¸­é—´)ä¸­ï¼Œè¿™æ ·å¯ä»¥é¿å…å¤æ‚çš„ä½ç½®è¿ç®—ã€‚<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">draw()&#123;</span><br><span class="line">  <span class="keyword">var</span> that=<span class="keyword">this</span>,</span><br><span class="line">      ctx=<span class="keyword">this</span>.ctx,</span><br><span class="line">      canvas=<span class="keyword">this</span>.canvas,</span><br><span class="line">      W=<span class="keyword">this</span>.W,</span><br><span class="line">      H=<span class="keyword">this</span>.H,</span><br><span class="line">      padding=<span class="keyword">this</span>.padding,</span><br><span class="line">      paddingTop=<span class="keyword">this</span>.paddingTop,</span><br><span class="line">      xl=<span class="number">0</span>,xs=<span class="number">0</span>,xdis=W-padding*<span class="number">2</span>,<span class="comment">//xè½´å•ä½æ•°ï¼Œæ¯ä¸ªå•ä½é•¿åº¦ï¼Œxè½´æ€»é•¿åº¦</span></span><br><span class="line">      yl=<span class="number">0</span>,ys=<span class="number">0</span>,ydis=H-padding*<span class="number">2</span>-paddingTop;<span class="comment">//yè½´å•ä½æ•°ï¼Œæ¯ä¸ªå•ä½é•¿åº¦ï¼Œyè½´æ€»é•¿åº¦</span></span><br><span class="line"></span><br><span class="line">  ctx.fillStyle=<span class="string">'hsla(0,0%,20%,1)'</span>;</span><br><span class="line">  ctx.strokeStyle=<span class="string">'hsla(0,0%,10%,1)'</span>;</span><br><span class="line">  ctx.lineWidth=<span class="number">1</span>;</span><br><span class="line">  ctx.textAlign=<span class="string">'center'</span>;</span><br><span class="line">  ctx.textBaseLine=<span class="string">'middle'</span>;</span><br><span class="line">  ctx.font=<span class="string">'24px arial'</span>;</span><br><span class="line"></span><br><span class="line">  ctx.clearRect(<span class="number">0</span>,<span class="number">0</span>,W,H);</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.title)&#123;</span><br><span class="line">    ctx.save();</span><br><span class="line">    ctx.textAlign=<span class="string">'left'</span>;</span><br><span class="line">    ctx.font=<span class="string">'bold 40px arial'</span>;</span><br><span class="line">    ctx.fillText(<span class="keyword">this</span>.title,padding<span class="number">-50</span>,<span class="number">70</span>);</span><br><span class="line">    ctx.restore();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.yAxis&amp;&amp;<span class="keyword">this</span>.yAxis.name)&#123;</span><br><span class="line">    ctx.fillText(<span class="keyword">this</span>.yAxis.name,padding,padding+paddingTop<span class="number">-30</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// xè½´</span></span><br><span class="line">  ctx.save();</span><br><span class="line">  ctx.beginPath();</span><br><span class="line">  ctx.translate(padding,H-padding);</span><br><span class="line">  ctx.moveTo(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">  ctx.lineTo(W<span class="number">-2</span>*padding,<span class="number">0</span>);</span><br><span class="line">  ctx.stroke();</span><br><span class="line">  <span class="comment">// xè½´åˆ»åº¦</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.xAxis&amp;&amp;(xl=<span class="keyword">this</span>.xAxis.data.length))&#123;</span><br><span class="line">    xs=(W<span class="number">-2</span>*padding)/xl;</span><br><span class="line">    <span class="keyword">this</span>.xAxis.data.forEach(<span class="function">(<span class="params">obj,i</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> x=xs*(i+<span class="number">1</span>);</span><br><span class="line">      ctx.moveTo(x,<span class="number">0</span>);</span><br><span class="line">      ctx.lineTo(x,<span class="number">10</span>);</span><br><span class="line">      ctx.stroke();</span><br><span class="line">      ctx.fillText(obj,x-xs/<span class="number">2</span>,<span class="number">40</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  ctx.restore();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// yè½´</span></span><br><span class="line">  ctx.save();</span><br><span class="line">  ctx.beginPath();</span><br><span class="line">  ctx.strokeStyle=<span class="string">'hsl(220,100%,50%)'</span>;</span><br><span class="line">  ctx.translate(padding,H-padding);</span><br><span class="line">  ctx.moveTo(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">  ctx.lineTo(<span class="number">0</span>,<span class="number">2</span>*padding+paddingTop-H);</span><br><span class="line">  ctx.stroke();</span><br><span class="line">  ctx.restore();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">this</span>.series.length)&#123;			</span><br><span class="line">    <span class="keyword">var</span> curr,txt,dim,info,item,tw=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="keyword">this</span>.series.length;i++)&#123;</span><br><span class="line">      item=<span class="keyword">this</span>.series[i];</span><br><span class="line">      <span class="keyword">if</span>(!item.data||!item.data.length)&#123;</span><br><span class="line">        <span class="keyword">this</span>.series.splice(i--,<span class="number">1</span>);<span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// èµ‹äºˆæ²¡æœ‰é¢œè‰²çš„é¡¹</span></span><br><span class="line">      <span class="keyword">if</span>(!item.color)&#123;</span><br><span class="line">        <span class="keyword">var</span> hsl=i%<span class="number">2</span>?<span class="number">180</span>+<span class="number">20</span>*i/<span class="number">2</span>:<span class="number">20</span>*(i<span class="number">-1</span>);</span><br><span class="line">        item.color=<span class="string">'hsla('</span>+hsl+<span class="string">',70%,60%,1)'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      item.name=item.name||<span class="string">'unnamed'</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// ç”»åˆ†ç»„æ ‡ç­¾</span></span><br><span class="line">      ctx.save();</span><br><span class="line">      ctx.translate(padding+W/<span class="number">4</span>,paddingTop+<span class="number">40</span>);</span><br><span class="line">      that.legend.push(&#123;</span><br><span class="line">        hide:item.hide||<span class="literal">false</span>,</span><br><span class="line">        name:item.name,</span><br><span class="line">        color:item.color,</span><br><span class="line">        x:padding+that.W/<span class="number">4</span>+i*<span class="number">90</span>+tw,</span><br><span class="line">        y:paddingTop+<span class="number">40</span>,</span><br><span class="line">        w:<span class="number">60</span>,</span><br><span class="line">        h:<span class="number">30</span>,</span><br><span class="line">        r:<span class="number">5</span></span><br><span class="line">      &#125;);</span><br><span class="line">      ctx.textAlign=<span class="string">'left'</span>;</span><br><span class="line">      ctx.fillStyle=item.color;</span><br><span class="line">      ctx.strokeStyle=item.color;</span><br><span class="line">      roundRect(ctx,i*<span class="number">90</span>+tw,<span class="number">0</span>,<span class="number">60</span>,<span class="number">30</span>,<span class="number">5</span>);</span><br><span class="line">      ctx.globalAlpha=item.hide?<span class="number">0.3</span>:<span class="number">1</span>;</span><br><span class="line">      ctx.fill();</span><br><span class="line">      ctx.fillText(item.name,i*<span class="number">90</span>+tw+<span class="number">70</span>,<span class="number">26</span>);</span><br><span class="line">      tw+=ctx.measureText(item.name).width;<span class="comment">//è®¡ç®—å­—ç¬¦é•¿åº¦</span></span><br><span class="line">      ctx.restore();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(item.hide)<span class="keyword">continue</span>;</span><br><span class="line">      <span class="comment">//è®¡ç®—æ•°æ®åœ¨Yè½´åˆ»åº¦</span></span><br><span class="line">      <span class="keyword">if</span>(!info)&#123;</span><br><span class="line">        info=calculateY(item.data.slice(<span class="number">0</span>,xl));</span><br><span class="line">      &#125;</span><br><span class="line">      curr=calculateY(item.data.slice(<span class="number">0</span>,xl));</span><br><span class="line">      <span class="keyword">if</span>(curr.max&gt;info.max)&#123;</span><br><span class="line">        info=curr;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!info) <span class="keyword">return</span>;</span><br><span class="line">    yl=info.num;</span><br><span class="line">    ys=ydis/yl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”»Yè½´åˆ»åº¦</span></span><br><span class="line">    ctx.save();</span><br><span class="line">    ctx.fillStyle=<span class="string">'hsl(200,100%,60%)'</span>;</span><br><span class="line">    ctx.translate(padding,H-padding);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;=yl;i++)&#123;</span><br><span class="line">      ctx.beginPath();</span><br><span class="line">      ctx.strokeStyle=<span class="string">'hsl(220,100%,50%)'</span>;</span><br><span class="line">      ctx.moveTo(<span class="number">-10</span>,-<span class="built_in">Math</span>.floor(ys*i));</span><br><span class="line">      ctx.lineTo(<span class="number">0</span>,-<span class="built_in">Math</span>.floor(ys*i));</span><br><span class="line">      ctx.stroke();</span><br><span class="line"></span><br><span class="line">      ctx.beginPath();</span><br><span class="line">      ctx.strokeStyle=<span class="string">'hsla(0,0%,80%,1)'</span>;</span><br><span class="line">      ctx.moveTo(<span class="number">0</span>,-<span class="built_in">Math</span>.floor(ys*i));</span><br><span class="line">      ctx.lineTo(xdis,-<span class="built_in">Math</span>.floor(ys*i));</span><br><span class="line">      ctx.stroke();</span><br><span class="line"></span><br><span class="line">      ctx.textAlign=<span class="string">'right'</span>;</span><br><span class="line">      dim=<span class="built_in">Math</span>.min(<span class="built_in">Math</span>.floor(info.step*i),info.max);</span><br><span class="line">      txt=<span class="keyword">this</span>.yAxis.formatter?<span class="keyword">this</span>.yAxis.formatter.replace(<span class="string">'&#123;value&#125;'</span>,dim):dim;</span><br><span class="line">      ctx.fillText(txt,<span class="number">-20</span>,-ys*i+<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ctx.restore();</span><br><span class="line">    <span class="comment">//ç”»æ•°æ®</span></span><br><span class="line">    <span class="keyword">this</span>.showData(xl,xs,info.max);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç»˜åˆ¶æ•°æ®"><a href="#ç»˜åˆ¶æ•°æ®" class="headerlink" title="ç»˜åˆ¶æ•°æ®"></a>ç»˜åˆ¶æ•°æ®</h2>å› ä¸ºæ•°æ®é¡¹éœ€è¦åç»­æ‰§è¡ŒåŠ¨ç”»å’Œé¼ æ ‡æ»‘è¿‡çš„æ—¶å€™æ˜¾ç¤ºå†…å®¹ï¼Œæ‰€ä»¥æŠŠå®ƒæ”¾è¿›åŠ¨ç”»é˜Ÿåˆ—animateArrä¸­ã€‚è¿™é‡Œè¦æŠŠåˆ†ç»„æ•°æ®å±•å¼€ï¼ŒæŠŠä¹‹å‰çš„ä¸¤æ¬¡åµŒå¥—çš„æ•°ç»„è½¬ä¸ºä¸€å±‚ï¼Œå¹¶è®¡ç®—å¥½æ¯ä¸ªæ•°æ®é¡¹çš„å±æ€§ï¼Œæ¯”å¦‚åç§°ï¼Œxåæ ‡ï¼Œyåæ ‡ï¼Œå®½åº¦ï¼Œé€Ÿåº¦ï¼Œé¢œè‰²ã€‚æ•°æ®ç»„ç»‡å®Œæ¯•åï¼Œæ¥ç€æ‰§è¡ŒåŠ¨ç”»ã€‚<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">showData(xl,xs,max)&#123;</span><br><span class="line">  <span class="comment">//ç”»æ•°æ®</span></span><br><span class="line">  <span class="keyword">var</span> that=<span class="keyword">this</span>,</span><br><span class="line">      ctx=<span class="keyword">this</span>.ctx,</span><br><span class="line">      ydis=<span class="keyword">this</span>.H-<span class="keyword">this</span>.padding*<span class="number">2</span>-<span class="keyword">this</span>.paddingTop,</span><br><span class="line">      sl=<span class="keyword">this</span>.series.filter(<span class="function"><span class="params">s</span>=&gt;</span>!s.hide).length,</span><br><span class="line">      sp=<span class="built_in">Math</span>.max(<span class="built_in">Math</span>.pow(<span class="number">10</span>-sl,<span class="number">2</span>)/<span class="number">3</span><span class="number">-4</span>,<span class="number">5</span>),</span><br><span class="line">      w=(xs-sp*(sl+<span class="number">1</span>))/sl,</span><br><span class="line">      h,x,index=<span class="number">0</span>;</span><br><span class="line">  that.animateArr.length=<span class="number">0</span>;</span><br><span class="line">  <span class="comment">// å±•å¼€æ•°æ®é¡¹ï¼Œå¡«å…¥åŠ¨ç”»é˜Ÿåˆ—</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,item,len=<span class="keyword">this</span>.series.length;i&lt;len;i++)&#123;</span><br><span class="line">    item=<span class="keyword">this</span>.series[i];</span><br><span class="line">    <span class="keyword">if</span>(item.hide)<span class="keyword">continue</span>;</span><br><span class="line">    item.data.slice(<span class="number">0</span>,xl).forEach(<span class="function">(<span class="params">d,j</span>)=&gt;</span>&#123;</span><br><span class="line">      h=d/max*ydis;</span><br><span class="line">      x=xs*j+w*index+sp*(index+<span class="number">1</span>);</span><br><span class="line">      that.animateArr.push(&#123;</span><br><span class="line">        index:i,</span><br><span class="line">        name:item.name,</span><br><span class="line">        num:d,</span><br><span class="line">        x:<span class="built_in">Math</span>.round(x),</span><br><span class="line">        y:<span class="number">1</span>,</span><br><span class="line">        w:<span class="built_in">Math</span>.round(w),</span><br><span class="line">        h:<span class="built_in">Math</span>.floor(h+<span class="number">2</span>),</span><br><span class="line">        vy:<span class="built_in">Math</span>.max(<span class="number">300</span>,<span class="built_in">Math</span>.floor(h*<span class="number">2</span>))/<span class="number">100</span>,</span><br><span class="line">        color:item.color</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    index++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.animate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ‰§è¡ŒåŠ¨ç”»"><a href="#æ‰§è¡ŒåŠ¨ç”»" class="headerlink" title="æ‰§è¡ŒåŠ¨ç”»"></a>æ‰§è¡ŒåŠ¨ç”»</h2>æ‰§è¡ŒåŠ¨ç”»ä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œé‡Œé¢å°±æ˜¯ä¸ªè‡ªæ‰§è¡Œé—­åŒ…å‡½æ•°ã€‚åŠ¨ç”»åŸç†å°±æ˜¯ç»™yè½´ä¾æ¬¡ç´¯åŠ é€Ÿåº¦å€¼vyã€‚ä½†è®°å¾—å½“é˜Ÿåˆ—æ‰§è¡Œå®ŒåŠ¨ç”»åï¼Œè¦åœæ­¢å®ƒï¼Œæ‰€ä»¥æœ‰ä¸ªisStopçš„æ ‡å¿—ï¼Œæ¯æ¬¡æ‰§è¡Œå®Œé˜Ÿåˆ—çš„æ—¶å€™å°±åˆ¤æ–­ã€‚<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">animate()&#123;</span><br><span class="line">  <span class="keyword">var</span> that=<span class="keyword">this</span>,</span><br><span class="line">      ctx=<span class="keyword">this</span>.ctx,</span><br><span class="line">      isStop=<span class="literal">true</span>;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    isStop=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,item;i&lt;that.animateArr.length;i++)&#123;</span><br><span class="line">      item=that.animateArr[i];</span><br><span class="line">      <span class="keyword">if</span>(item.y-item.h&gt;=<span class="number">0.1</span>)&#123;</span><br><span class="line">        item.y=item.h;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        item.y+=item.vy;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(item.y&lt;item.h)&#123;</span><br><span class="line">        ctx.save();</span><br><span class="line">        <span class="comment">// ctx.translate(that.padding+item.x,that.H-that.padding);</span></span><br><span class="line">        ctx.fillStyle=item.color;</span><br><span class="line">        ctx.fillRect(that.padding+item.x,that.H-that.padding-item.y,item.w,item.y);</span><br><span class="line">        ctx.restore();</span><br><span class="line">        isStop=<span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(isStop)<span class="keyword">return</span>;</span><br><span class="line">    requestAnimationFrame(run);</span><br><span class="line">  &#125;())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="ç»‘å®šäº‹ä»¶"><a href="#ç»‘å®šäº‹ä»¶" class="headerlink" title="ç»‘å®šäº‹ä»¶"></a>ç»‘å®šäº‹ä»¶</h2><p>äº‹ä»¶ä¸€ï¼šmousemoveçš„æ—¶å€™ï¼Œçœ‹çœ‹é¼ æ ‡ä½ç½®æ˜¯ä¸æ˜¯å¤„äºåˆ†ç»„æ ‡ç­¾è¿˜æ˜¯æ•°æ®é¡¹ä¸Šï¼Œç»˜åˆ¶è·¯å¾„åè°ƒç”¨isPointInPath(x,y)ï¼Œtrueåˆ™é¼ æ ‡è®¾ç½®ä¸ºæ‰‹å½¢ï¼›å¦‚æœæ˜¯æ•°æ®é¡¹çš„è¯ï¼Œè¿˜è¦æŠŠè¯¥æŸ±å½¢é‡æ–°ç»˜åˆ¶ï¼Œè®¾ç½®é€æ˜åº¦ï¼ŒåŒºåˆ†å‡ºæ¥ã€‚è¿˜éœ€è¦æŠŠå†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªç›¸å¯¹çˆ¶å®¹å™¨containerä¸ºç»å¯¹å®šä½çš„divï¼Œåˆå§‹åŒ–çš„æ—¶å€™å·²ç»å»ºç«‹ä¸ºtipå±æ€§äº†ã€‚æˆ‘ä»¬æŠŠæ˜¾ç¤ºéƒ¨åˆ†å°è£…æˆshowInfoæ–¹æ³•ã€‚</p>
<p>äº‹ä»¶äºŒï¼šmousedownçš„æ—¶å€™ï¼Œä¸€æ ·ç»˜åˆ¶è·¯å¾„è°ƒç”¨isPointInPathåˆ¤æ–­é¼ æ ‡ç‚¹å‡»å“ªä¸ªåˆ†ç»„æ ‡ç­¾ï¼Œç„¶åè®¾ç½®å¯¹åº”åˆ†ç»„æ•°æ®seriesä¸­çš„hideå±æ€§ï¼Œå¦‚æœæ˜¯trueï¼Œè¡¨ç¤ºä¸æ˜¾ç¤ºè¯¥é¡¹ï¼Œç„¶åè°ƒç”¨drawæ–¹æ³•ï¼Œé‡å†™æ¸²æŸ“ç»˜åˆ¶ï¼Œæ‰§è¡ŒåŠ¨ç”»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">bindEvent()&#123;</span><br><span class="line">  <span class="keyword">var</span> that=<span class="keyword">this</span>,</span><br><span class="line">      canvas=<span class="keyword">this</span>.canvas,</span><br><span class="line">      ctx=<span class="keyword">this</span>.ctx;</span><br><span class="line">  <span class="keyword">this</span>.canvas.addEventListener(<span class="string">'mousemove'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> isLegend=<span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// pos=WindowToCanvas(canvas,e.clientX,e.clientY);</span></span><br><span class="line">    <span class="keyword">var</span> box=canvas.getBoundingClientRect();</span><br><span class="line">    <span class="keyword">var</span> pos = &#123;</span><br><span class="line">      x:e.clientX-box.left,</span><br><span class="line">      y:e.clientY-box.top</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// åˆ†ç»„æ ‡ç­¾</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,item,len=that.legend.length;i&lt;len;i++)&#123;</span><br><span class="line">      item=that.legend[i];</span><br><span class="line">      ctx.save();</span><br><span class="line">      roundRect(ctx,item.x,item.y,item.w,item.h,item.r);</span><br><span class="line">      <span class="comment">// å› ä¸ºç¼©å°äº†ä¸€å€ï¼Œæ‰€ä»¥åæ ‡è¦*2</span></span><br><span class="line">      <span class="keyword">if</span>(ctx.isPointInPath(pos.x*<span class="number">2</span>,pos.y*<span class="number">2</span>))&#123;</span><br><span class="line">        canvas.style.cursor=<span class="string">'pointer'</span>;</span><br><span class="line">        ctx.restore();</span><br><span class="line">        isLegend=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      canvas.style.cursor=<span class="string">'default'</span>;</span><br><span class="line">      ctx.restore();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(isLegend) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//é€‰æ‹©æ•°æ®é¡¹</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,item,len=that.animateArr.length;i&lt;len;i++)&#123;</span><br><span class="line">      item=that.animateArr[i];</span><br><span class="line">      ctx.save();</span><br><span class="line">      ctx.fillStyle=item.color;</span><br><span class="line">      ctx.beginPath();</span><br><span class="line">      ctx.rect(that.padding+item.x,that.H-that.padding-item.h,item.w,item.h);</span><br><span class="line">      <span class="keyword">if</span>(ctx.isPointInPath(pos.x*<span class="number">2</span>,pos.y*<span class="number">2</span>))&#123;</span><br><span class="line">        <span class="comment">//æ¸…ç©ºåå†é‡æ–°ç»˜åˆ¶é€æ˜åº¦ä¸º0.5çš„å›¾å½¢</span></span><br><span class="line">        ctx.clearRect(that.padding+item.x,that.H-that.padding-item.h,item.w,item.h);</span><br><span class="line">        ctx.globalAlpha=<span class="number">0.5</span>;</span><br><span class="line">        ctx.fill();</span><br><span class="line">        canvas.style.cursor=<span class="string">'pointer'</span>;</span><br><span class="line">        that.showInfo(pos,item);</span><br><span class="line">        ctx.restore();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      canvas.style.cursor=<span class="string">'default'</span>;</span><br><span class="line">      that.tip.style.display=<span class="string">'none'</span>;</span><br><span class="line">      ctx.globalAlpha=<span class="number">1</span>;</span><br><span class="line">      ctx.fill();</span><br><span class="line">      ctx.restore();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;,<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.canvas.addEventListener(<span class="string">'mousedown'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="keyword">var</span> box=canvas.getBoundingClientRect();</span><br><span class="line">    <span class="keyword">var</span> pos = &#123;</span><br><span class="line">      x:e.clientX-box.left,</span><br><span class="line">      y:e.clientY-box.top</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,item,len=that.legend.length;i&lt;len;i++)&#123;</span><br><span class="line">      item=that.legend[i];</span><br><span class="line">      roundRect(ctx,item.x,item.y,item.w,item.h,item.r);</span><br><span class="line">      <span class="comment">// å› ä¸ºç¼©å°äº†ä¸€å€ï¼Œæ‰€ä»¥åæ ‡è¦*2</span></span><br><span class="line">      <span class="keyword">if</span>(ctx.isPointInPath(pos.x*<span class="number">2</span>,pos.y*<span class="number">2</span>))&#123;</span><br><span class="line">        that.series[i].hide=!that.series[i].hide;</span><br><span class="line">        that.animateArr.length=<span class="number">0</span>;</span><br><span class="line">        that.draw();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;,<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ˜¾ç¤ºæ•°æ®</span></span><br><span class="line">showInfo(pos,obj)&#123;</span><br><span class="line">  <span class="keyword">var</span> txt=<span class="keyword">this</span>.yAxis.formatter?<span class="keyword">this</span>.yAxis.formatter.replace(<span class="string">'&#123;value&#125;'</span>,obj.num):obj.num;</span><br><span class="line">  <span class="keyword">var</span> box=<span class="keyword">this</span>.canvas.getBoundingClientRect();</span><br><span class="line">  <span class="keyword">var</span> con=<span class="keyword">this</span>.container.getBoundingClientRect();</span><br><span class="line">  <span class="keyword">this</span>.tip.innerHTML = <span class="string">'&lt;p&gt;'</span>+obj.name+<span class="string">':'</span>+txt+<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line">  <span class="keyword">this</span>.tip.style.left=(pos.x+(box.left-con.left)+<span class="number">10</span>)+<span class="string">'px'</span>;</span><br><span class="line">  <span class="keyword">this</span>.tip.style.top=(pos.y+(box.top-con.top)+<span class="number">10</span>)+<span class="string">'px'</span>;</span><br><span class="line">  <span class="keyword">this</span>.tip.style.display=<span class="string">'block'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ‰€æœ‰å›¾è¡¨ä»£ç è¯·çœ‹*<a href="https://github.com/edwardzhong/html5Canvas/blob/master/chart/chart.js" target="_blank" rel="noopener">chart.js</a>*ã€‚è¿™é‡Œå®Œæˆçš„åªæ˜¯ä¸ªåŸºæœ¬çš„æ•ˆæœï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šåœ°æ–¹è¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œæ¯”å¦‚å“åº”å¼çš„æ”¯æŒï¼Œç§»åŠ¨ç«¯çš„æ”¯æŒï¼ŒåŠ¨ç”»çš„æ•ˆæœï¼Œå¤šyè½´çš„æ”¯æŒï¼Œæ˜¾ç¤ºå†…å®¹çš„æ•ˆæœï¼ŒåŒæ—¶æ”¯æŒæŠ˜çº¿åŠŸèƒ½ç­‰ã€‚</p>
</div>
    	
		<div class="post-footer">
			<div class="tags">
				<i class="icon-tags"></i> 
				
					
					
						
							<a href="/blog/tags/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a>
						
					
						
							<a href="/blog/tags/js/">js</a>
						
					
						
							<a href="/blog/tags/canvas/">canvas</a>
						
					
				
			</div>
			<a class="share" href="javascript:;" data-url="/blog/2017/11/12/chartbar/" data-desc="
å‰å‡ å¤©ç”¨åˆ°äº†å›¾è¡¨åº“ï¼Œå…¶ä¸­ç™¾åº¦çš„EChartsï¼Œæ„Ÿè§‰åšå¾—æœ€å¥½ï¼Œçœ‹å®ƒé»˜è®¤ç”¨çš„æ˜¯canvasï¼Œca..." data-type="share" title="share"><i class="icon-share"></i></a>
		</div>
	</div>
</article>
</div>
<nav class="pagination clearfix">
  
    
      
        <a href="/blog/2017/11/14/webgl3d/" class="prev post-prev"> <i class="icon-leftarrow"></i> WebGLå­¦ä¹ (2) - 3Dåœºæ™¯</a>
      

      
        <a href="/blog/2017/11/08/webgltriangle/" class="next post-next"> WebGLå­¦ä¹ (1) - ä¸‰è§’å½¢ <i class="icon-rightarrow"></i></a>
      
    
  
</nav>

<div class="wxshare-popup">
    <a class="close" href="javascript:;"></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div id="qrcode" class="wx-qrcode"></div>
</div>

    
    <footer class="footer">
<p class="theme">
	Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/edwardzhong/simply.git" target="_blank" rel="noopener">simply</a>
</p>
<p class="copy">Copyright &copy; 2021 Jeff Zhong</p>
</footer>
    <div class="top-bottom">
      <div class="to-top hide" title="to top"><i class="icon-up"></i></div>
      <div class="to-bottom hide" title="to bottom"><i class="icon-down"></i></div>
    </div>
    </div>

  </div>
<input type="hidden" name="isPost" id="isPost" value="true">
<i id="barBtn" class="icon icon-menu"></i>
<div id="payMe" class="payme">
    <i class="icon icon-cancel"></i>
    <p class="pay-title">ç»™æˆ‘çš„æ—©é¤åŠ ä¸ªè›‹å§ ğŸ˜Š</p>
    <div>
      <img src="/images/weixinpay.jpg" alt="weixinpay">
      <img src="/images/alipay.jpg" alt="alipay" style="display:none;">
    </div>
    <div class="pay-selects">
        <input type="radio" name="pay" id="weixinpay" checked="checked"><label for="weixinpay"> å¾®ä¿¡ </label>&nbsp;&nbsp;
        <input type="radio" name="pay" id="alipay"><label for="alipay"> æ”¯ä»˜å® </label>
    </div>
</div>

  
  
    <script src="/blog/lib/jquery-2.2.3.min.js"></script>
  
    <script src="/blog/lib/qrcode.min.js"></script>
  
    <script src="/blog/js/index.js"></script>
  

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</body>
</html>
