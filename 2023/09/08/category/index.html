<!doctype html>
<html lang="zh-CN">









<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <!-- ä¼˜å…ˆä½¿ç”¨ IE æœ€æ–°ç‰ˆæœ¬å’Œ Chrome -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <!-- ä¸ºç§»åŠ¨è®¾å¤‡æ·»åŠ  viewport -->
  <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <!-- æ·»åŠ åˆ°ä¸»å±åçš„æ ‡é¢˜ï¼ˆiOS 6 æ–°å¢ï¼‰ -->
  <meta name="apple-mobile-web-app-title" content="æœºå™¨å­¦ä¹ ä¹‹åˆ†ç±» - Jeff's world">
  <!-- æ˜¯å¦å¯ç”¨ WebApp å…¨å±æ¨¡å¼ï¼Œåˆ é™¤è‹¹æœé»˜è®¤çš„å·¥å…·æ å’Œèœå•æ  -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <!-- è®¾ç½®è‹¹æœå·¥å…·æ é¢œè‰² -->
  <meta name="apple-mobile-web-app-status-bar-style" content = "black" />
  <!-- æ·»åŠ æ™ºèƒ½ App å¹¿å‘Šæ¡ Smart App Bannerï¼ˆiOS 6+ Safariï¼‰ -->
  <!-- <meta name = "apple-itunes-app" content = "app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"> -->
  <!-- å¿½ç•¥é¡µé¢ä¸­çš„æ•°å­—è¯†åˆ«ä¸ºç”µè¯ï¼Œå¿½ç•¥emailè¯†åˆ« -->
  <meta name="format-detection" content = "telphone=no, email=no" />
  <!--ä¸‹é¢ä¸‰ä¸ªæ˜¯æ¸…é™¤ç¼“å­˜ å¾®ä¿¡æµè§ˆå™¨ç¼“å­˜ä¸¥é‡åˆæ— åˆ·æ–°ï¼›è¿™ä¸ªæ–¹æ³•è°ƒè¯•çš„æ—¶å€™å¾ˆæ–¹ä¾¿-->
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <link rel="dns-prefetch" href="https://jeff_zhong.gitee.io">
  <link rel="icon shortcut" type="image/ico" href="/favicon.ico">
  <meta name="author" content="Jeff Zhong">
  <meta name="description" content="it's a blog by hexo">
  <meta name="keywords" content="hexo theme">
  <title >æœºå™¨å­¦ä¹ ä¹‹åˆ†ç±» - Jeff's world</title>
    <!-- The Open Graph protocol -->
  <meta property="og:url" content="https://jeff_zhong.gitee.io">
  <meta property="og:type" content="blog">
  <meta property="og:title" content="æœºå™¨å­¦ä¹ ä¹‹åˆ†ç±» - Jeff's world">
  <meta property="og:description" content="it's a blog by hexo">
  
    
    
      <link rel="stylesheet" href="/blog/lib/fontello/fontello.css">
    
      <link rel="stylesheet" href="/blog/lib/reboto/roboto.css">
    
      <link rel="stylesheet" href="/blog/css/index.css">
    
  
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5255e97b442092b8e1a219e6a48a0d42";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/blog/atom.xml" title="Jeff's world" type="application/atom+xml">
</head>
<body>
<header class="header">
  <div class="top"></div>
  <h2>Jeff's World</h2>
  <h3>Things that I'm interested in</h3>
  <div class="menu">
  
  
  
      <a  href="/blog/" title="ä¸» é¡µ">
        <i class="icon-home"></i>
        <span>ä¸» é¡µ</span>
      </a>
  
      <a  href="https://jeff_zhong.gitee.io/demo/" title="Demo">
        <i class="icon-page"></i>
        <span>Demo</span>
      </a>
  
      <a  data-tag="search"  href="javascript:;" title="æœ ç´¢">
        <i class="icon-search"></i>
        <span>æœ ç´¢</span>
      </a>
  
  </div>
  <div class="state">
  
    <a href="/blog/archives">53<br>æ–‡ ç« </a><a href="/blog/categories">2<br>åˆ† ç±»</a><a href="/blog/tags">70<br>æ ‡ ç­¾</a>
  </div>
  <div class="social">
  
  
  
      <a href="https://github.com/edwardzhong" target="_blank" rel="noopener" title="Github"><i class="icon-github"></i></a>
  
      <a href="https://twitter.com/JianfengEdward" target="_blank" rel="noopener" title="Twitter"><i class="icon-twitter"></i></a>
  
      <a href="https://www.facebook.com/jianfeng.edward" target="_blank" rel="noopener" title="Facebook"><i class="icon-facebook"></i></a>
  
      <a href="http://weibo.com/1593251850" target="_blank" rel="noopener" title="Weibo"><i class="icon-weibo"></i></a>
  
      <a href="/blog/atom.xml" title="Rss"><i class="icon-rss"></i></a>
  
  </div>
  <div id="payBtn" class="pay-icon" title="è°¢è°¢æ‚¨çš„èµèµ">èµ</div>
</header>
  <div class="container">
    <div class="main">
    
        
<div class="post-list">
	<article class="post" style="animation:listshow 0.6s ease-out both 0.30000000000000004s">
    
    
        
    
	
	<a href="javascript:;">
        <div class="post-banner" style="background: url(/blog/images/banner5.jpg)  center top / 100% no-repeat">
    		<h3 class="post-title">æœºå™¨å­¦ä¹ ä¹‹åˆ†ç±»</h3>
    	</div>
	</a>
	<div class="post-inner">
	
    	<div class="post-info">
    		<time><i class="icon-calendar"></i> 2023/09/08 16:56:00</time>
    		<span class="category">
    		
    			
    			<i class="icon-book"></i>
    			
                    
                        <a href="/blog/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
                    
    			
    		
    		</span>
    	</div>
    	<!-- <p><p>åˆ†ç±»ä»»åŠ¡å’Œå›å½’ä»»åŠ¡çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œåˆ†ç±»ä»»åŠ¡éœ€è¦åšå‡ºç¦»æ•£çš„é¢„æµ‹ã€‚å¯¹äºå¤šåˆ†ç±»ä»»åŠ¡çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå…¶è¾“å‡ºç›®æ ‡é€šå¸¸ä¼šç”¨one-hotç¼–ç æ¥è¡¨ç¤ºï¼Œåœ¨è¾“å‡ºå±‚ä¸­ä½¿ç”¨softmaxå‡½æ•°ï¼ŒåŒæ—¶ä½¿ç”¨åˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½â€¦</p>
</p> -->
    	
    		<div class="post-content"><p>åˆ†ç±»ä»»åŠ¡å’Œå›å½’ä»»åŠ¡çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œåˆ†ç±»ä»»åŠ¡éœ€è¦åšå‡ºç¦»æ•£çš„é¢„æµ‹ã€‚å¯¹äºå¤šåˆ†ç±»ä»»åŠ¡çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå…¶è¾“å‡ºç›®æ ‡é€šå¸¸ä¼šç”¨<strong>one-hot</strong>ç¼–ç æ¥è¡¨ç¤ºï¼Œåœ¨è¾“å‡ºå±‚ä¸­ä½¿ç”¨<strong>softmax</strong>å‡½æ•°ï¼ŒåŒæ—¶ä½¿ç”¨åˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°è¿›è¡Œè®­ç»ƒã€‚åœ¨æœ¬åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong>TensorFlow</strong>çš„åº•å±‚APIå®ç°ä¸€ä¸ªåŸºäºå…¨è¿æ¥å±‚çš„ç¥ç»ç½‘ç»œæ¥è¿›è¡Œ<strong>MNIST</strong>æ•°å­—å›¾åƒåˆ†ç±»ã€‚ä¸‹é¢æ˜¯æ¶‰åŠåˆ°çš„ç›¸å…³æ¦‚å¿µï¼š</p>
<p><strong>æ·±åº¦å­¦ä¹ </strong>æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œå®ƒé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œå±‚æ¬¡åŒ–åœ°æå–ç‰¹å¾ï¼Œä»¥è§£å†³å„ç§å¤æ‚çš„åˆ†ç±»å’Œå›å½’é—®é¢˜ã€‚</p>
<p><strong>ç¥ç»ç½‘ç»œ</strong>æ˜¯æ·±åº¦å­¦ä¹ çš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼Œç”±å¤šä¸ªå±‚æ¬¡åŒ–çš„ç¥ç»å…ƒç»„æˆã€‚è¾“å…¥å±‚æ¥å—æ•°æ®ï¼Œä¸­é—´çš„éšè—å±‚é€šè¿‡æƒé‡å’Œæ¿€æ´»å‡½æ•°å¤„ç†æ•°æ®ï¼Œæœ€ç»ˆè¾“å‡ºå±‚äº§ç”Ÿåˆ†ç±»ç»“æœã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ‰‹åŠ¨å®ç°ç¥ç»ç½‘ç»œçš„æ ¸å¿ƒç»„ä»¶ã€‚</p>
<p><strong>å‰å‘ä¼ æ’­</strong>æ˜¯ç¥ç»ç½‘ç»œä¸­çš„ä¿¡æ¯ä¼ é€’è¿‡ç¨‹ï¼Œä»è¾“å…¥å±‚åˆ°è¾“å‡ºå±‚ï¼Œæ¯ä¸€å±‚çš„ç¥ç»å…ƒæ ¹æ®æƒé‡å’Œæ¿€æ´»å‡½æ•°è®¡ç®—è¾“å‡ºã€‚è¿™ä¸ªè¿‡ç¨‹å°†è¾“å…¥æ•°æ®æ˜ å°„åˆ°é¢„æµ‹è¾“å‡ºã€‚</p>
<p><strong>åå‘ä¼ æ’­</strong>æ˜¯è®­ç»ƒç¥ç»ç½‘ç»œçš„å…³é”®æ­¥éª¤ï¼Œå®ƒé€šè¿‡è®¡ç®—é¢„æµ‹ä¸çœŸå®æ ‡ç­¾ä¹‹é—´çš„è¯¯å·®ï¼Œå¹¶å°†è¯¯å·®åå‘ä¼ æ’­åˆ°ç½‘ç»œä¸­çš„æ¯ä¸€å±‚æ¥æ›´æ–°æƒé‡ï¼Œä»¥æœ€å°åŒ–è¯¯å·®ã€‚</p>
<a id="more"></a>

<h2 id="å†…å®¹å¤§çº²"><a href="#å†…å®¹å¤§çº²" class="headerlink" title="å†…å®¹å¤§çº²"></a>å†…å®¹å¤§çº²</h2><ol>
<li>ç¥ç»ç½‘ç»œæ ¸å¿ƒç»„ä»¶çš„å®ç°</li>
<li>æ•°æ®åŠ è½½å¤„ç†</li>
<li>æ„å»ºè®­ç»ƒæ¨¡å‹</li>
<li>æ€»ç»“</li>
</ol>
<h2 id="ç¥ç»ç½‘ç»œæ ¸å¿ƒç»„ä»¶çš„å®ç°"><a href="#ç¥ç»ç½‘ç»œæ ¸å¿ƒç»„ä»¶çš„å®ç°" class="headerlink" title="ç¥ç»ç½‘ç»œæ ¸å¿ƒç»„ä»¶çš„å®ç°"></a>ç¥ç»ç½‘ç»œæ ¸å¿ƒç»„ä»¶çš„å®ç°</h2><p>ä»¥ä¸‹ä»£ç åˆ†åˆ«å®ç°äº†å¯†é›†å±‚<strong>DenseLayer</strong>ï¼Œç½‘ç»œæ¨¡å‹<strong>SequentialModel</strong>ï¼Œæ‰¹æ¬¡ç”Ÿæˆå™¨<strong>BatchGenerator</strong>ï¼Œæ‰¹æ¬¡æƒé‡æ›´æ–°<strong>one_training_step</strong> ä»¥åŠ è®­ç»ƒå‡½æ•°<strong>fit</strong>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DenseLayer</span>:</span>  <span class="comment"># ç®€å•çš„Denseç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, input_size, output_size, activation)</span>:</span></span><br><span class="line">        self.activation = activation</span><br><span class="line"></span><br><span class="line">        w_shape = (input_size, output_size)  <span class="comment"># åˆ›å»ºä¸€ä¸ªå½¢çŠ¶ä¸º(input_size, output_size)çš„çŸ©é˜µWï¼Œå¹¶å°†å…¶éšæœºåˆå§‹åŒ–</span></span><br><span class="line">        w_initial_value = tf.random.uniform(w_shape, minval=<span class="number">0</span>, maxval=<span class="number">1e-1</span>)</span><br><span class="line">        self.W = tf.Variable(w_initial_value)</span><br><span class="line"></span><br><span class="line">        b_shape = (output_size,)  <span class="comment"># åˆ›å»ºä¸€ä¸ªå½¢çŠ¶ä¸º(output_size,)çš„é›¶å‘é‡b</span></span><br><span class="line">        b_initial_value = tf.zeros(b_shape)</span><br><span class="line">        self.b = tf.Variable(b_initial_value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, inputs)</span>:</span>  <span class="comment"># å‰å‘ä¼ æ’­</span></span><br><span class="line">        <span class="keyword">return</span> self.activation(tf.matmul(inputs, self.W) + self.b)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">weights</span><span class="params">(self)</span>:</span>  <span class="comment"># è·å–è¯¥å±‚æƒé‡</span></span><br><span class="line">        <span class="keyword">return</span> [self.W, self.b]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SequentialModel</span>:</span>  <span class="comment"># ç®€å•çš„Sequentialç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, layers)</span>:</span></span><br><span class="line">        self.layers = layers</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, inputs)</span>:</span></span><br><span class="line">        x = inputs</span><br><span class="line">        <span class="keyword">for</span> layer <span class="keyword">in</span> self.layers:</span><br><span class="line">            x = layer(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">weights</span><span class="params">(self)</span>:</span></span><br><span class="line">        weights = []</span><br><span class="line">        <span class="keyword">for</span> layer <span class="keyword">in</span> self.layers:</span><br><span class="line">            weights += layer.weights</span><br><span class="line">        <span class="keyword">return</span> weights</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BatchGenerator</span>:</span>  <span class="comment"># æ‰¹é‡ç”Ÿæˆå™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, images, labels, batch_size=<span class="number">128</span>)</span>:</span></span><br><span class="line">        <span class="keyword">assert</span> len(images) == len(labels)</span><br><span class="line">        self.index = <span class="number">0</span></span><br><span class="line">        self.images = images</span><br><span class="line">        self.labels = labels</span><br><span class="line">        self.batch_size = batch_size</span><br><span class="line">        self.num_batches = math.ceil(len(images) / batch_size)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        images = self.images[self.index: self.index + self.batch_size]</span><br><span class="line">        labels = self.labels[self.index: self.index + self.batch_size]</span><br><span class="line">        self.index += self.batch_size</span><br><span class="line">        <span class="keyword">return</span> images, labels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°å‚æ•°</span></span><br><span class="line">learning_rate = <span class="number">1e-3</span> <span class="comment"># å­¦ä¹ ç‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_weights</span><span class="params">(gradients, weights)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> g, w <span class="keyword">in</span> zip(gradients, weights):</span><br><span class="line">        w.assign_sub(g * learning_rate)  <span class="comment"># assign_subç›¸å½“äºTensorFlowå˜é‡çš„-=</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ¢¯åº¦ï¼Œå¹¶æ›´æ–°æƒé‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_training_step</span><span class="params">(model, images_batch, labels_batch)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape:  <span class="comment"># è¿è¡Œå‰å‘ä¼ æ’­ï¼Œå³åœ¨GradientTapeä½œç”¨åŸŸå†…è®¡ç®—æ¨¡å‹é¢„æµ‹å€¼</span></span><br><span class="line">        predictions = model(images_batch)</span><br><span class="line">        <span class="comment"># æ ‡ç­¾ç¼–ç ä¸ºæ•´æ•°ï¼Œä½¿ç”¨sparse_categorical_crossentropyæŸå¤±å‡½æ•°</span></span><br><span class="line">        per_sample_losses = tf.keras.losses.sparse_categorical_crossentropy(labels_batch, predictions)</span><br><span class="line">        average_loss = tf.reduce_mean(per_sample_losses)</span><br><span class="line">    gradients = tape.gradient(average_loss, model.weights)  <span class="comment"># è®¡ç®—æŸå¤±ç›¸å¯¹äºæƒé‡çš„æ¢¯åº¦ã€‚è¾“å‡ºgradientsæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ å¯¹åº”model.weightsåˆ—è¡¨ä¸­çš„æƒé‡</span></span><br><span class="line">    update_weights(gradients, model.weights)  <span class="comment"># åˆ©ç”¨æ¢¯åº¦æ¥æ›´æ–°æƒé‡</span></span><br><span class="line">    <span class="keyword">return</span> average_loss</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®Œæ•´çš„è®­ç»ƒå¾ªç¯</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(model, images, labels, epochs, batch_size=<span class="number">128</span>)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> epoch_counter <span class="keyword">in</span> range(epochs):</span><br><span class="line">        print(<span class="string">f"Epoch <span class="subst">&#123;epoch_counter&#125;</span>"</span>)</span><br><span class="line">        batch_generator = BatchGenerator(images, labels)</span><br><span class="line">        <span class="keyword">for</span> batch_counter <span class="keyword">in</span> range(batch_generator.num_batches):</span><br><span class="line">            images_batch, labels_batch = batch_generator.next()</span><br><span class="line">            loss = one_training_step(model, images_batch, labels_batch)</span><br><span class="line">            <span class="keyword">if</span> batch_counter % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">                print(<span class="string">f"loss at batch <span class="subst">&#123;batch_counter&#125;</span>: <span class="subst">&#123;loss:<span class="number">.2</span>f&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="æ•°æ®åŠ è½½å¤„ç†"><a href="#æ•°æ®åŠ è½½å¤„ç†" class="headerlink" title="æ•°æ®åŠ è½½å¤„ç†"></a>æ•°æ®åŠ è½½å¤„ç†</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡æ•°æ®ã€‚<strong>MNIST</strong>æ•°æ®é›†åŒ…å«æ‰‹å†™æ•°å­—å›¾åƒï¼Œæ¯ä¸ªå›¾åƒæ˜¯28x28åƒç´ çš„ç°åº¦å›¾åƒï¼Œæ€»å…±æœ‰10ä¸ªç±»åˆ«ï¼ˆ0åˆ°9ï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½MNISTæ•°æ®é›†</span></span><br><span class="line">(train_images, train_labels), (test_images, test_labels) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½’ä¸€åŒ–åƒç´ å€¼åˆ°0åˆ°1ä¹‹é—´</span></span><br><span class="line">train_images = train_images.reshape((<span class="number">60000</span>, <span class="number">28</span> * <span class="number">28</span>)).astype(<span class="string">"float32"</span>) / <span class="number">255</span></span><br><span class="line">test_images = test_images.reshape((<span class="number">10000</span>, <span class="number">28</span> * <span class="number">28</span>)).astype(<span class="string">"float32"</span>) / <span class="number">255</span></span><br></pre></td></tr></table></figure>

<h2 id="æ„å»ºè®­ç»ƒæ¨¡å‹"><a href="#æ„å»ºè®­ç»ƒæ¨¡å‹" class="headerlink" title="æ„å»ºè®­ç»ƒæ¨¡å‹"></a>æ„å»ºè®­ç»ƒæ¨¡å‹</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong>DenseLayer</strong> å’Œ <strong>SequentialModel</strong> ç±»æ„å»ºä¸€ä¸ªä¸¤å±‚çš„å…¨è¿æ¥ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ©ç”¨è¿™ä¸ªDenseLayerç±»å’ŒSequentialModelç±»ï¼Œåˆ›å»ºä¸€ä¸ªä¸Kerasç±»ä¼¼çš„æ¨¡å‹</span></span><br><span class="line">model = SequentialModel([</span><br><span class="line">    DenseLayer(input_size=<span class="number">28</span> * <span class="number">28</span>, output_size=<span class="number">512</span>, activation=tf.nn.relu),<span class="comment"># å…¨è¿æ¥å±‚ï¼Œ512ä¸ªå•å…ƒï¼ŒReLUæ¿€æ´»å‡½æ•°</span></span><br><span class="line">    DenseLayer(input_size=<span class="number">512</span>, output_size=<span class="number">10</span>, activation=tf.nn.softmax) <span class="comment"># è¾“å‡ºå±‚ï¼Œ10ä¸ªè¾“å‡ºå•å…ƒå¯¹åº”0-9çš„æ•°å­—ï¼Œä½¿ç”¨softmaxæ¿€æ´»å‡½æ•°</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ‰‹åŠ¨å®ç°çš„ç¥ç»ç½‘ç»œæ¨¡å‹æ¥è¿›è¡Œè®­ç»ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¼€å§‹è®­ç»ƒ</span></span><br><span class="line">fit(model, train_images, train_labels, epochs=<span class="number">10</span>, batch_size=<span class="number">128</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹ç»“æœå‡†ç¡®ç‡</span></span><br><span class="line">predictions = model(test_images).numpy()</span><br><span class="line">predicted_labels = np.argmax(predictions, axis=<span class="number">1</span>)</span><br><span class="line">matches = predicted_labels == test_labels</span><br><span class="line">print(<span class="string">f"accuracy: <span class="subst">&#123;matches.mean():<span class="number">.2</span>f&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨æœ¬åšå®¢ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<strong>TensorFlow</strong>çš„åº•å±‚APIæ‰‹åŠ¨å®ç°äº†ä¸€ä¸ªåŸºäºå…¨è¿æ¥å±‚çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå¹¶å°†å…¶åº”ç”¨äº<strong>MNIST</strong>æ•°å­—å›¾åƒåˆ†ç±»ã€‚æˆ‘ä»¬æ¶µç›–äº†æ·±åº¦å­¦ä¹ åˆ†ç±»çš„åŸºæœ¬åŸç†ï¼ŒåŒ…æ‹¬ç¥ç»ç½‘ç»œã€å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ã€‚é€šè¿‡é€‚å½“çš„æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€è®­ç»ƒå’Œé¢„æµ‹ï¼Œæˆ‘ä»¬æˆåŠŸåœ°åˆ†ç±»äº†æ‰‹å†™æ•°å­—å›¾åƒï¼Œè¿™æ˜¯æ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰ä¸­çš„ä¸€ä¸ªå…¸å‹åº”ç”¨ã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©ä½ äº†è§£æ·±åº¦å­¦ä¹ åˆ†ç±»çš„åŸºæœ¬æµç¨‹å’Œå®ç°ç»†èŠ‚ã€‚é€šè¿‡åº•å±‚APIçš„å®ç°ï¼Œä½ å¯ä»¥æ›´æ·±å…¥åœ°ç†è§£æ·±åº¦å­¦ä¹ æ¨¡å‹çš„å†…éƒ¨å·¥ä½œåŸç†ã€‚</p>
</div>
    	
		<div class="post-footer">
			<div class="tags">
				<i class="icon-tags"></i> 
				
					
					
						
							<a href="/blog/tags/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a>
						
					
						
							<a href="/blog/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a>
						
					
						
							<a href="/blog/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a>
						
					
				
			</div>
			<a class="share" href="javascript:;" data-url="/blog/2023/09/08/category/" data-desc="åˆ†ç±»ä»»åŠ¡å’Œå›å½’ä»»åŠ¡çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œåˆ†ç±»ä»»åŠ¡éœ€è¦åšå‡ºç¦»æ•£çš„é¢„æµ‹ã€‚å¯¹äºå¤šåˆ†ç±»ä»»åŠ¡çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå…¶..." data-type="share" title="share"><i class="icon-share"></i></a>
		</div>
	</div>
</article>
</div>
<nav class="pagination clearfix">
  
    
      

      
        <a href="/blog/2023/07/12/linear/" class="next post-next"> æœºå™¨å­¦ä¹ ä¹‹çº¿æ€§å›å½’ <i class="icon-rightarrow"></i></a>
      
    
  
</nav>

<div class="wxshare-popup">
    <a class="close" href="javascript:;"></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div id="qrcode" class="wx-qrcode"></div>
</div>

    
    <footer class="footer">
<p class="theme">
	Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/edwardzhong/simply.git" target="_blank" rel="noopener">simply</a>
</p>
<p class="copy">Copyright &copy; 2025 Jeff Zhong</p>
</footer>
    <div class="top-bottom">
      <div class="to-top hide" title="to top"><i class="icon-up"></i></div>
      <div class="to-bottom hide" title="to bottom"><i class="icon-down"></i></div>
    </div>
    </div>

  </div>
<input type="hidden" name="isPost" id="isPost" value="true">
<i id="barBtn" class="icon icon-menu"></i>
<div id="payMe" class="payme">
    <i class="icon icon-cancel"></i>
    <p class="pay-title">ç»™æˆ‘çš„æ—©é¤åŠ ä¸ªè›‹å§ ğŸ˜Š</p>
    <div>
      <img src="/images/weixinpay.jpg" alt="weixinpay">
      <img src="/images/alipay.jpg" alt="alipay" style="display:none;">
    </div>
    <div class="pay-selects">
        <input type="radio" name="pay" id="weixinpay" checked="checked"><label for="weixinpay"> å¾®ä¿¡ </label>&nbsp;&nbsp;
        <input type="radio" name="pay" id="alipay"><label for="alipay"> æ”¯ä»˜å® </label>
    </div>
</div>

  
  
    <script src="/blog/lib/jquery-2.2.3.min.js"></script>
  
    <script src="/blog/lib/qrcode.min.js"></script>
  
    <script src="/blog/js/index.js"></script>
  

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</body>
</html>
