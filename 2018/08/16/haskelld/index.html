<!doctype html>
<html lang="zh-CN">









<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <!-- ä¼˜å…ˆä½¿ç”¨ IE æœ€æ–°ç‰ˆæœ¬å’Œ Chrome -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <!-- ä¸ºç§»åŠ¨è®¾å¤‡æ·»åŠ  viewport -->
  <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <!-- æ·»åŠ åˆ°ä¸»å±åçš„æ ‡é¢˜ï¼ˆiOS 6 æ–°å¢ï¼‰ -->
  <meta name="apple-mobile-web-app-title" content="Haskellå­¦ä¹ -monad - Jeff's world">
  <!-- æ˜¯å¦å¯ç”¨ WebApp å…¨å±æ¨¡å¼ï¼Œåˆ é™¤è‹¹æœé»˜è®¤çš„å·¥å…·æ å’Œèœå•æ  -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <!-- è®¾ç½®è‹¹æœå·¥å…·æ é¢œè‰² -->
  <meta name="apple-mobile-web-app-status-bar-style" content = "black" />
  <!-- æ·»åŠ æ™ºèƒ½ App å¹¿å‘Šæ¡ Smart App Bannerï¼ˆiOS 6+ Safariï¼‰ -->
  <!-- <meta name = "apple-itunes-app" content = "app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"> -->
  <!-- å¿½ç•¥é¡µé¢ä¸­çš„æ•°å­—è¯†åˆ«ä¸ºç”µè¯ï¼Œå¿½ç•¥emailè¯†åˆ« -->
  <meta name="format-detection" content = "telphone=no, email=no" />
  <!--ä¸‹é¢ä¸‰ä¸ªæ˜¯æ¸…é™¤ç¼“å­˜ å¾®ä¿¡æµè§ˆå™¨ç¼“å­˜ä¸¥é‡åˆæ— åˆ·æ–°ï¼›è¿™ä¸ªæ–¹æ³•è°ƒè¯•çš„æ—¶å€™å¾ˆæ–¹ä¾¿-->
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <link rel="dns-prefetch" href="https://jeff_zhong.gitee.io/blog">
  <link rel="icon shortcut" type="image/ico" href="/favicon.ico">
  <meta name="author" content="Jeff Zhong">
  <meta name="description" content="it's a blog by hexo">
  <meta name="keywords" content="hexo theme">
  <title >Haskellå­¦ä¹ -monad - Jeff's world</title>
    <!-- The Open Graph protocol -->
  <meta property="og:url" content="https://jeff_zhong.gitee.io/blog">
  <meta property="og:type" content="blog">
  <meta property="og:title" content="Haskellå­¦ä¹ -monad - Jeff's world">
  <meta property="og:description" content="it's a blog by hexo">
  
    
    
      <link rel="stylesheet" href="/lib/fontello/fontello.css">
    
      <link rel="stylesheet" href="/lib/reboto/roboto.css">
    
      <link rel="stylesheet" href="/css/index.css">
    
  
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5255e97b442092b8e1a219e6a48a0d42";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Jeff's world" type="application/atom+xml">
</head>
<body>
<header class="header">
  <div class="top"></div>
  <h2>Jeff's World</h2>
  <h3>Things that I'm interested in</h3>
  <div class="menu">
  
  
  
      <a  href="/" title="ä¸» é¡µ">
        <i class="icon-home"></i>
        <span>ä¸» é¡µ</span>
      </a>
  
      <a  href="https://jeff_zhong.gitee.io/demo/" title="Demo">
        <i class="icon-page"></i>
        <span>Demo</span>
      </a>
  
      <a  data-tag="search"  href="javascript:;" title="æœ ç´¢">
        <i class="icon-search"></i>
        <span>æœ ç´¢</span>
      </a>
  
  </div>
  <div class="state">
  
    <a href="/archives">53<br>æ–‡ ç« </a><a href="/categories">2<br>åˆ† ç±»</a><a href="/tags">70<br>æ ‡ ç­¾</a>
  </div>
  <div class="social">
  
  
  
      <a href="https://github.com/edwardzhong" target="_blank" rel="noopener" title="Github"><i class="icon-github"></i></a>
  
      <a href="https://twitter.com/JianfengEdward" target="_blank" rel="noopener" title="Twitter"><i class="icon-twitter"></i></a>
  
      <a href="https://www.facebook.com/jianfeng.edward" target="_blank" rel="noopener" title="Facebook"><i class="icon-facebook"></i></a>
  
      <a href="http://weibo.com/1593251850" target="_blank" rel="noopener" title="Weibo"><i class="icon-weibo"></i></a>
  
      <a href="/atom.xml" title="Rss"><i class="icon-rss"></i></a>
  
  </div>
  <div id="payBtn" class="pay-icon" title="è°¢è°¢æ‚¨çš„èµèµ">èµ</div>
</header>
  <div class="container">
    <div class="main">
    
        
<div class="post-list">
	<article class="post" style="animation:listshow 0.6s ease-out both 0.30000000000000004s">
    
    
        
    
	
	<a href="javascript:;">
        <div class="post-banner" style="background: url(/blog/images/banner3.jpg)  center top / 100% no-repeat">
    		<h3 class="post-title">Haskellå­¦ä¹ -monad</h3>
    	</div>
	</a>
	<div class="post-inner">
	
    	<div class="post-info">
    		<time><i class="icon-calendar"></i> 2018/08/16 09:29:00</time>
    		<span class="category">
    		
    			
    			<i class="icon-book"></i>
    			
                    
                        <a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>
                    
    			
    		
    		</span>
    	</div>
    	<!-- <p><p>ä»€ä¹ˆæ˜¯MonadHaskellæ˜¯ä¸€é—¨çº¯å‡½æ•°å¼çš„è¯­è¨€ï¼Œçº¯å‡½æ•°çš„ä¼˜ç‚¹æ˜¯å®‰å…¨å¯é ã€‚å‡½æ•°è¾“å‡ºå®Œå…¨å–å†³äºè¾“å…¥ï¼Œä¸å­˜åœ¨ä»»ä½•éšå¼ä¾èµ–ï¼Œå®ƒçš„å­˜åœ¨å¦‚åŒæ•°å­¦å…¬å¼èˆ¬å®Œç¾æ— ç¼ºã€‚å¯æ˜¯çº¯å‡½æ•°å› ä¸ºéš”ç»äº†å¤–éƒ¨ç¯å¢ƒï¼Œè¿æœ€åŸºæœ¬â€¦</p>
</p> -->
    	
    		<div class="post-content"><!-- åŸæ–‡åœ°å€ï¼š[Haskellå­¦ä¹ -monad](https://jeff_zhong.gitee.io/blog/2018/08/16/haskelld/) -->

<h2 id="ä»€ä¹ˆæ˜¯Monad"><a href="#ä»€ä¹ˆæ˜¯Monad" class="headerlink" title="ä»€ä¹ˆæ˜¯Monad"></a>ä»€ä¹ˆæ˜¯Monad</h2><p>Haskellæ˜¯ä¸€é—¨çº¯å‡½æ•°å¼çš„è¯­è¨€ï¼Œçº¯å‡½æ•°çš„ä¼˜ç‚¹æ˜¯å®‰å…¨å¯é ã€‚å‡½æ•°è¾“å‡ºå®Œå…¨å–å†³äºè¾“å…¥ï¼Œä¸å­˜åœ¨ä»»ä½•éšå¼ä¾èµ–ï¼Œå®ƒçš„å­˜åœ¨å¦‚åŒæ•°å­¦å…¬å¼èˆ¬å®Œç¾æ— ç¼ºã€‚å¯æ˜¯çº¯å‡½æ•°å› ä¸ºéš”ç»äº†å¤–éƒ¨ç¯å¢ƒï¼Œè¿æœ€åŸºæœ¬çš„è¾“å…¥è¾“å‡ºéƒ½æ— æ³•å®Œæˆã€‚è€Œ <strong>Monad</strong> å°±æ˜¯ Haskell ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆã€‚ä½†<strong>Monad</strong> å¹¶ä¸ä»…ä»…æ˜¯ IO æ“ä½œçš„æŠ½è±¡ï¼Œå®ƒæ›´æ˜¯å¤šç§ç±»ä¼¼æ“ä½œä¹‹é—´å…±æ€§çš„æŠ½è±¡ã€‚æ‰€ä»¥ Monad è§£å†³çš„é—®é¢˜å¹¶ä¸å±€é™åœ¨ IO ä¸Šï¼Œåƒ Haskell ä¸­çš„ <strong>Maybe</strong> å’Œ <strong>[]</strong> éƒ½æ˜¯ <strong>Monad</strong>ã€‚Haskell ä¸­æ¼‚äº®çš„é”™è¯¯å¤„ç†æ–¹å¼ï¼Œ <strong>do</strong> è¡¨ç¤ºæ³•å’Œçµæ´»çš„åˆ—è¡¨æ¨å¯¼å¼ (<strong>list comprehension</strong>) éƒ½ç®—æ˜¯ <strong>Monad</strong> çš„è´¡çŒ®ã€‚</p>
<a id="more"></a>

<p><strong>Monad</strong> åŸºæœ¬ä¸Šæ˜¯ä¸€ç§åŠ å¼ºç‰ˆçš„ <strong>Applicative Functor</strong>ï¼Œæ­£å¦‚ <strong>Applicative Functor</strong> æ˜¯ <strong>Functor</strong> çš„åŠ å¼ºç‰ˆä¸€æ ·ã€‚æ‰€ä»¥åœ¨å……åˆ†ç†è§£ <strong>Applicative Functor</strong> çš„åŸºç¡€ä¸Šï¼Œè¿‡æ¸¡åˆ° <strong>Monad</strong> å…¶å®æ˜¯éå¸¸å¹³æ»‘çš„ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- Monadçš„å®šä¹‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">Monad</span> m <span class="keyword">where</span></span></span><br><span class="line">    return :: a -&gt; m a</span><br><span class="line">    (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</span><br><span class="line">    (&gt;&gt;) :: m a -&gt; m b -&gt; m b</span><br><span class="line">    x &gt;&gt; y = x &gt;&gt;= \_ -&gt; y</span><br><span class="line">    fail :: <span class="type">String</span> -&gt; m a</span><br><span class="line">    fail msg = error msg</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>return</strong> è·Ÿå…¶ä»–è¯­è¨€ä¸­çš„ <strong>return</strong> æ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠŠæ™®é€šå€¼åŒ…è¿›ä¸€ä¸ª context é‡Œé¢çš„å‡½æ•°ï¼Œå¹¶ä¸æ˜¯ç»“æŸå‡½æ•°æ‰§è¡Œçš„å…³é”®å­—ã€‚å…¶å®ç­‰ä»·äºApplicativeä¸­çš„ <strong>pure</strong>ã€‚</li>
<li><strong>&gt;&gt;</strong> å¿½ç•¥å‰é¢è¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œç›´æ¥æ‰§è¡Œå½“å‰è¡¨è¾¾å¼ã€‚</li>
<li><strong>&gt;&gt;=</strong> æ¥å—ä¸€ä¸ª monadic valueï¼ˆä¹Ÿå°±æ˜¯å…·æœ‰ context çš„å€¼ï¼Œå¯ä»¥ç”¨è£…æœ‰æ™®é€šå€¼çš„ç›’å­æ¥æ¯”å–»ï¼‰å¹¶ä¸”æŠŠå®ƒå–‚ç»™ä¸€ä¸ªæ¥å—æ™®é€šå€¼çš„å‡½æ•°ï¼Œå¹¶å›ä¼ ä¸€ä¸ª monadic valueã€‚</li>
<li><strong>=&lt;&lt;</strong> å’Œä¸Šé¢ <strong>&gt;&gt;=</strong> åŠŸèƒ½ä¸€æ ·ï¼Œåªæ˜¯ç»“åˆé¡ºåºç›¸åã€‚</li>
</ul>
<h2 id="Monad-çš„åŸç†"><a href="#Monad-çš„åŸç†" class="headerlink" title="Monad çš„åŸç†"></a>Monad çš„åŸç†</h2><p>å‡½æ•°ä¹‹é—´è¦åä½œï¼Œå°±å¿…é¡»ä»¥å„ç§å½¢å¼äº¤äº’è¿æ¥ã€‚ä½†å¦‚ä½•éš”ç¦»çº¯å‡½æ•°ä¸å‰¯ä½œç”¨å‡½æ•°ï¼ŒåŒæ—¶åˆèƒ½è®©ä¸¤ç±»å‡½æ•°ç›¸äº’å¤ç”¨å‘¢ï¼Ÿ</p>
<p>ä»¥ IO æ“ä½œä¸ºä¾‹å­åˆ†æï¼Œä¸ºäº†å……åˆ†éš”ç¦»çº¯å‡½æ•°ä¸ IO å‡½æ•°ï¼ŒHaskell ä¸­ä¸èƒ½å®ç° <strong>IO Char -&gt; Char</strong> è¿™æ ·ä¸€ç§è¾“å…¥æ˜¯ IO ç±»å‹è¿”å›å€¼å´æ˜¯æ™®é€šç±»å‹çš„å‡½æ•°ã€‚å¦åˆ™å‰¯ä½œç”¨å‡½æ•°å°±èƒ½å¾ˆå®¹æ˜“å˜èº«ä¸ºçº¯å‡½æ•°äº†ã€‚äº‹å®ä¸Šä¸€æ—¦å‚æ•°ä¸­æœ‰ IOï¼Œè¿”å›å€¼å¿…æœ‰ IOï¼Œè¿™å°±ä¿è¯äº†å……åˆ†éš”ç¦»ã€‚</p>
<p>é‚£å¦‚ä½•è®©çº¯å‡½æ•°ä¸ IO å‡½æ•°ç›¸äº’å¤ç”¨å‘¢ï¼Ÿè¿™å°±è¦é  IO Monad ä¸­å®šä¹‰çš„ <strong>return</strong> å’Œ <strong>&gt;&gt;=</strong> è¿™ä¸¤ä¸ªå‡½æ•°äº†ã€‚<strong>return</strong> ï¼ˆåœ¨ Haskell ä¸­ä¸æ˜¯å…³é”®å­—ï¼Œåªæ˜¯ä¸€ä¸ªå‡½æ•°åï¼‰çš„ä½œç”¨æ˜¯å°†æŸä¸ªç±»å‹ä¸º <strong>A</strong> çš„å€¼ <strong>a</strong> æå‡ï¼ˆè£…ç®±ï¼‰ä¸ºç±»å‹ä¸º <strong>IO A</strong> çš„å€¼ <strong>Char -&gt; IO Char</strong> ã€‚æœ‰äº†è¿™ä¸ªå‡½æ•°åï¼Œçº¯å‡½æ•°å°±å¯ä»¥é€šè¿‡ <strong>return</strong> å˜æˆè¿”å›å€¼ä¸º IO å¸¦å‰¯ä½œç”¨çš„å‡½æ•°äº†ã€‚</p>
<p>æœ‰äº†æå‡è€Œæ²¡æœ‰ä¸‹é™æ“ä½œï¼Œæ€ä¹ˆå¤åˆ <strong>putChar :: Char -&gt; IO()</strong> ä¸ <strong>getChar :: IO Char</strong> å‘¢ã€‚ getChar ä» IO è¯»å–ä¸€ä¸ªå­—ç¬¦ï¼Œ putChar æŠŠå­—ç¬¦å†™å…¥ IOã€‚ä½† <strong>getChar</strong> è¿”å›çš„æ˜¯ <strong>IO Char</strong> ç±»å‹ï¼Œè€Œ <strong>putChar</strong> éœ€è¦çš„æ˜¯æ™®é€šçš„ <strong>Char</strong> ç±»å‹ï¼Œä¸¤è€…ä¸åŒ¹é…æ€ä¹ˆåŠï¼Ÿ <strong>&gt;&gt;=</strong> å‡½æ•°å‡ºé©¬äº†ï¼ <strong>&gt;&gt;=</strong> çš„ç±»å‹æ˜¯</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="type">IO</span> a -&gt; (a -&gt; <span class="type">IO</span> b) -&gt; <span class="type">IO</span> b</span><br></pre></td></tr></table></figure>

<p>è¿™æ · <strong>&gt;&gt;=</strong> å°±å¯ä»¥è¿æ¥ <strong>getChar</strong> ä¸ <strong>putChar</strong> ï¼ŒæŠŠè¾“å…¥å†™åˆ°è¾“å‡ºä¸­</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">getChar</span> &gt;&gt;= putChar</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° <strong>&gt;&gt;=</strong> æ“ä½œå®é™…ä¸Šæ˜¯ç±»å‹ä¸‹é™ï¼ˆæˆ–æ‹†ç®±ï¼‰æ“ä½œï¼ŒåŒæ—¶æ‰§è¡Œä¸‹é™æ“ä½œçš„å‡½æ•°è¿”å›å€¼ä¹Ÿå¿…é¡»æ˜¯ IO ç±»å‹ã€‚è¿™æ ·æ—¢å……åˆ†éš”ç¦»çº¯å‡½æ•°ä¸å‰¯ä½œç”¨å‡½æ•°ï¼Œåˆèƒ½è®©å‡½æ•°ç›¸äº’å¤ç”¨ã€‚é€šè¿‡ <strong>return</strong> å’Œ <strong>&gt;&gt;=</strong> ä¸¤ä¸ªå¹³è¡Œä¸–ç•Œ (èŒƒç•´) å°±æœ‰äº†å¯æ§çš„äº¤æµé€šé“ã€‚</p>
<h2 id="do-è¡¨ç¤ºæ³•"><a href="#do-è¡¨ç¤ºæ³•" class="headerlink" title="do è¡¨ç¤ºæ³•"></a>do è¡¨ç¤ºæ³•</h2><p>Haskellçš„ do è¡¨ç¤ºæ³•å®é™…ä¸Šæ˜¯Monadçš„è¯­æ³•ç³–ï¼šå®ƒç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§ä¸ä½¿ç”¨ (<strong>&gt;&gt;=</strong>) å’ŒåŒ¿åå‡½æ•°æ¥å†™monadicä»£ç çš„æ–¹å¼ã€‚å»é™¤doè¯­æ³•ç³–çš„è¿‡ç¨‹å°±æ˜¯æŠŠå®ƒè½¬æ¢ä¸º (<strong>&gt;&gt;=</strong>) å’ŒåŒ¿åå‡½æ•°ã€‚</p>
<p>do è¡¨ç¤ºæ³•å¯ä»¥ä½¿ç”¨åˆ†å· <strong>;</strong> å’Œå¤§æ‹¬å· <strong>{ }</strong>  å°†è¯­å¥åˆ†å—ï¼›ä½†ä¸€èˆ¬ä¼šä½¿ç”¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸€è¡Œçš„æ–¹å¼ï¼Œä¸åŒçš„ä½œç”¨åŸŸç”¨ä¸åŒçš„ç¼©è¿›åŒºåˆ†ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ˜¯ä»¥IO ä¸ºä¾‹å­ï¼Œæ¥å—ä¸¤æ¬¡çš„é”®ç›˜è¾“å…¥ï¼Œç„¶åå°†ä¸¤æ¬¡è¾“å…¥çš„å­—ç¬¦ä¸²åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæœ€åå±å¹•æ‰“å°è¾“å‡ºã€‚ <strong>&gt;&gt;=</strong> ä¼šæ¥å—å‰é¢è¡¨è¾¾å¼çš„å€¼ï¼›<strong>&gt;&gt;</strong> åˆ™ä¼šå¿½ç•¥å‰é¢è¡¨è¾¾å¼çš„å€¼ï¼›è¿™é‡Œä½¿ç”¨ <strong>return</strong> å®é™…å®ƒè¿”å›çš„ä»ç„¶æ˜¯IO Stringï¼Œå› ä¸ºHaskellä¼šè‡ªåŠ¨ç±»å‹æ¨å¯¼å¾—å‡ºã€‚monadic çš„è¡¨è¾¾å¼ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">(++) &lt;$&gt; getLine &lt;*&gt; getLine &gt;&gt;= print &gt;&gt; return <span class="string">"over"</span></span><br><span class="line"><span class="number">111</span></span><br><span class="line"><span class="number">222</span></span><br><span class="line">&gt; <span class="string">"111222"</span></span><br><span class="line">&gt; <span class="string">"over"</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ doæ”¹å†™ï¼Œæ˜æ˜¾æ›´åŠ æ¸…æ™°ï¼Œå’Œæˆ‘ä»¬ç†Ÿæ‚‰çš„å‘½ä»¤å¼è¯­è¨€é£æ ¼å·®ä¸å¤šã€‚<br><strong>&lt;-</strong> è¡¨ç¤ºä»monadic valueä¸­å–å‡ºæ™®é€šå€¼ï¼Œå¯ä»¥çœ‹æˆæ˜¯æ‹†å¼€ç›’å­å–å‡ºæ‰€éœ€è¦çš„å€¼ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">foo</span> :: <span class="type">IO</span> <span class="type">String</span>  </span><br><span class="line"><span class="title">foo</span> = <span class="keyword">do</span>  </span><br><span class="line">    x &lt;- getLine</span><br><span class="line">    y &lt;- getLine</span><br><span class="line">    print (x ++ y)</span><br><span class="line">    return <span class="string">"over"</span></span><br></pre></td></tr></table></figure>

<p>doè¯­æ³•å¯¹åº”æ¨¡å¼</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">do</span> &#123;e&#125;             -&gt; e</span><br><span class="line"><span class="title">do</span> &#123;e; es&#125;         -&gt; e &gt;&gt; <span class="keyword">do</span> &#123;es&#125;</span><br><span class="line"><span class="title">do</span> &#123;<span class="keyword">let</span> decls; es&#125; -&gt; <span class="keyword">let</span> decls <span class="keyword">in</span> <span class="keyword">do</span> &#123;es&#125;</span><br><span class="line"><span class="title">do</span> &#123;p &lt;- e; es&#125;    -&gt; e &gt;&gt;= \p -&gt; es</span><br></pre></td></tr></table></figure>

<h2 id="Monad-ç±»å‹"><a href="#Monad-ç±»å‹" class="headerlink" title="Monad ç±»å‹"></a>Monad ç±»å‹</h2><p>æ¥çœ‹ä¸€ä¸‹å‡ ä¸ªé»˜è®¤çš„Monadç±»å‹ï¼Œå®ƒä»¬éƒ½å¿…é¡»å®ç° <strong>return</strong>,<strong>&gt;&gt;=</strong>,<strong>fail</strong>è¿™å‡ ä¸ªå‡½æ•°ã€‚</p>
<ol>
<li><p><strong>Maybe</strong><br>ä¸­é—´ä»»ä½•ä¸€æ­¥åªè¦æœ‰<strong>Nothing</strong>ï¼Œç»“æœå°±æå‰è¿”å›<strong>Nothing</strong>ã€‚æ²¡æœ‰ä»»ä½•æ„å¤–çš„æƒ…å†µæ‰è¿”å›<strong>Just å€¼</strong>ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- Maybe çš„ Monad instance</span></span><br><span class="line"><span class="class"><span class="keyword">instance</span> <span class="type">Monad</span> <span class="type">Maybe</span> <span class="keyword">where</span></span></span><br><span class="line">    return x = <span class="type">Just</span> x</span><br><span class="line">    <span class="type">Nothing</span> &gt;&gt;= f = <span class="type">Nothing</span></span><br><span class="line">    <span class="type">Just</span> x &gt;&gt;= f  = f x</span><br><span class="line">    fail _ = <span class="type">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å®ä¾‹</span></span><br><span class="line"><span class="type">Just</span> <span class="number">3</span> &gt;&gt;= (\x -&gt; <span class="type">Nothing</span> &gt;&gt;= (\y -&gt; <span class="type">Just</span> (show x ++ y)))</span><br><span class="line">&gt; <span class="type">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="type">Just</span> <span class="number">3</span> &gt;&gt;= (\x -&gt; <span class="type">Just</span> <span class="string">"!"</span> &gt;&gt;= (\y -&gt; <span class="type">Just</span> (show x ++ y)))</span><br><span class="line">&gt; <span class="type">Just</span> <span class="string">"3!"</span></span><br></pre></td></tr></table></figure>

<p> ä½¿ç”¨ do è¡¨ç¤ºæ³•å†™æˆè¿™æ ·ï¼š</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">foo</span> :: <span class="type">Maybe</span> <span class="type">String</span></span><br><span class="line"><span class="title">foo</span> = <span class="keyword">do</span></span><br><span class="line">    x &lt;- <span class="type">Just</span> <span class="number">3</span></span><br><span class="line">    y &lt;- <span class="type">Just</span> <span class="string">"!"</span></span><br><span class="line">    <span class="type">Just</span> (show x ++ y)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>List</strong><br><strong>&gt;&gt;=</strong> åŸºæœ¬ä¸Šå°±æ˜¯æ¥å—ä¸€ä¸ªæœ‰ context çš„å€¼ï¼ŒæŠŠä»–å–‚è¿›ä¸€ä¸ªåªæ¥å—æ™®é€šå€¼çš„å‡½æ•°ï¼Œå¹¶å›ä¼ ä¸€ä¸ªå…·æœ‰ context çš„å€¼ã€‚<strong>[]</strong> å…¶å®ç­‰ä»·äº Nothingã€‚</p>
<p> å½“æˆ‘ä»¬ç”¨ <strong>&gt;&gt;=</strong> æŠŠä¸€ä¸ª list å–‚ç»™è¿™ä¸ªå‡½æ•°ï¼Œlambda ä¼šæ˜ å°„æ¯ä¸ªå…ƒç´ ï¼Œä¼šè®¡ç®—å‡ºä¸€ä¸²åŒ…å«ä¸€å † list çš„ listï¼Œæœ€åå†æŠŠè¿™äº› list å‹æ‰ï¼Œå¾—åˆ°ä¸€å±‚çš„ listã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¾—åˆ° åˆ—è¡¨ <strong>list</strong> å¤„ç† Mondic value çš„è¿‡ç¨‹ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="comment">--list çš„ Monad instance</span></span><br><span class="line"><span class="class"><span class="keyword">instance</span> <span class="type">Monad</span> [] <span class="keyword">where</span></span></span><br><span class="line">    return x = [x]</span><br><span class="line">    xs &gt;&gt;= f = concat (map f xs)</span><br><span class="line">    fail _ = []</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å®ä¾‹</span></span><br><span class="line">[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>] &gt;&gt;= \x -&gt; [x,-x]</span><br><span class="line">&gt; [<span class="number">3</span>,<span class="number">-3</span>,<span class="number">4</span>,<span class="number">-4</span>,<span class="number">5</span>,<span class="number">-5</span>]</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>] &gt;&gt;= \x -&gt; return (-x)</span><br><span class="line">&gt; [<span class="number">-1</span>,<span class="number">-2</span>,<span class="number">-3</span>]</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><p><strong>list comprehension</strong> ä¹Ÿä¸è¿‡æ˜¯ <strong>Monad</strong> çš„è¯­æ³•ç³–</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>,<span class="number">2</span>] &gt;&gt;= \n -&gt; ['a','b'] &gt;&gt;= \ch -&gt; return (n,ch) <span class="comment">-- Monad</span></span><br><span class="line">[ (n,ch) | n &lt;- [<span class="number">1</span>,<span class="number">2</span>], ch &lt;- ['a','b'] ] <span class="comment">-- list comprehension</span></span><br><span class="line">&gt; [(<span class="number">1</span>,'a'),(<span class="number">1</span>,'b'),(<span class="number">2</span>,'a'),(<span class="number">2</span>,'b')]</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>list comprehension</strong> çš„è¿‡æ»¤åŸºæœ¬ä¸Šè·Ÿ guard æ˜¯ä¸€è‡´çš„ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">[<span class="number">1.</span><span class="number">.50</span>] &gt;&gt;= (\x -&gt; guard ('<span class="number">7</span>' `elem` show x) &gt;&gt; return x)</span><br><span class="line">&gt; [<span class="number">7</span>,<span class="number">17</span>,<span class="number">27</span>,<span class="number">37</span>,<span class="number">47</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”¨ <strong>do</strong> æ”¹å†™, å¦‚æœä¸å†™æœ€åä¸€è¡Œ <strong>return x</strong>ï¼Œé‚£æ•´ä¸ª list å°±ä¼šæ˜¯åŒ…å«ä¸€å †ç©º <strong>tuple</strong> çš„ listã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">sevensOnly</span> :: [<span class="type">Int</span>]</span><br><span class="line"><span class="title">sevensOnly</span> = <span class="keyword">do</span></span><br><span class="line">    x &lt;- [<span class="number">1.</span><span class="number">.50</span>]</span><br><span class="line">    guard ('<span class="number">7</span>' `elem` show x)</span><br><span class="line">    return x</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¯¹åº”çš„ list comprehension</span></span><br><span class="line">[ x | x &lt;- [<span class="number">1.</span><span class="number">.50</span>], '<span class="number">7</span>' `elem` show x ]</span><br><span class="line">&gt; [<span class="number">7</span>,<span class="number">17</span>,<span class="number">27</span>,<span class="number">37</span>,<span class="number">47</span>]</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3">
<li><p><strong>Either</strong><br>åœ¨ <strong>Control.Monad.Error</strong> é‡Œé¢æœ‰ <strong>Error</strong>çš„ <strong>Monad instance</strong>ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">instance</span> (<span class="type">Error</span> <span class="title">e</span>) =&gt; <span class="type">Monad</span> (<span class="type">Either</span> <span class="title">e</span>) <span class="keyword">where</span></span></span><br><span class="line">    return x = <span class="type">Right</span> x</span><br><span class="line">    <span class="type">Right</span> x &gt;&gt;= f = f x</span><br><span class="line">    <span class="type">Left</span> err &gt;&gt;= f = <span class="type">Left</span> err</span><br><span class="line">    fail msg = <span class="type">Left</span> (strMsg msg)</span><br><span class="line"></span><br><span class="line"><span class="type">Right</span> <span class="number">3</span> &gt;&gt;= \x -&gt; return (x + <span class="number">100</span>) :: <span class="type">Either</span> <span class="type">String</span> <span class="type">Int</span></span><br><span class="line">&gt; <span class="type">Right</span> <span class="number">103</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Monad-è§„åˆ™"><a href="#Monad-è§„åˆ™" class="headerlink" title="Monad è§„åˆ™"></a>Monad è§„åˆ™</h2><ol>
<li><p><strong>return a &gt;&gt;= f ==  f a</strong><br>== å·¦è¾¹çš„è¡¨è¾¾å¼ç­‰ä»·äºå³è¾¹çš„è¡¨è¾¾å¼ã€‚å¦‚æœä»…ä»…æ˜¯æŠŠä¸€ä¸ªå€¼åŒ…è£…åˆ°monadé‡Œé¢ç„¶åä½¿ç”¨ (<strong>&gt;&gt;=</strong>) è°ƒç”¨çš„è¯ï¼Œæˆ‘ä»¬å°±æ²¡æœ‰å¿…è¦ä½¿ç”¨ <strong>return</strong> ï¼›è¿™æ¡è§„åˆ™å¯¹äºæˆ‘ä»¬çš„ä»£ç é£æ ¼æœ‰ç€å®é™…çš„æŒ‡å¯¼æ„ä¹‰ï¼šæˆ‘ä»¬ä¸åº”è¯¥å†™ä¸€äº›ä¸å¿…è¦çš„ä»£ç ï¼›è¿™æ¡è§„åˆ™ä¿è¯äº†ç®€çŸ­çš„å†™æ³•å’Œå†—ä½™çš„å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">return</span> <span class="number">3</span> &gt;&gt;= (\x -&gt; <span class="type">Just</span> (x+<span class="number">100000</span>)) <span class="comment">-- å’Œç›´æ¥å‡½æ•°è°ƒç”¨æ²¡æœ‰åŒºåˆ«</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>m &gt;&gt;= return == m</strong><br>è¿™ä¸€æ¡è§„åˆ™å¯¹é£æ ¼ä¹Ÿæœ‰å¥½å¤„ï¼šå¦‚æœåœ¨ä¸€ç³»åˆ—çš„actionå—é‡Œé¢ï¼Œå¦‚æœæœ€åä¸€å¥å°±æ˜¯éœ€è¦è¿”å›çš„æ­£ç¡®ç»“æœï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦ä½¿ç”¨ return äº†ï¼›å’Œç¬¬ä¸€æ¡è§„åˆ™ä¸€æ ·ï¼Œè¿™æ¡è§„å¾‹ä¹Ÿèƒ½å¸®åŠ©æˆ‘ä»¬ç®€åŒ–ä»£ç ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="type">Just</span> <span class="string">"move on up"</span> &gt;&gt;= return <span class="comment">-- å¯ä»¥ä¸éœ€è¦ return</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>(m &gt;&gt;= f) &gt;&gt;= g  == m &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</strong><br>å½“æˆ‘ä»¬ç”¨ &gt;&gt;= æŠŠä¸€ä¸² monadic function ä¸²åœ¨ä¸€èµ·ï¼Œä»–ä»¬çš„å…ˆåé¡ºåºä¸åº”è¯¥å½±å“ç»“æœã€‚<br>è€Œè¿™ä¸å°±æ˜¯ç»“åˆå¾‹å—ï¼Ÿæˆ‘ä»¬å¯ä»¥æŠŠé‚£äº›å­actionæå–å‡ºæ¥ç»„åˆæˆä¸€ä¸ªæ–°actionã€‚<br> (<strong>&lt;=&lt;</strong>) å¯ä»¥ç”¨æ¥åˆæˆä¸¤ä¸ª monadic functions, ç±»ä¼¼äºæ™®é€šå‡½æ•°ç»“åˆ(<strong>.</strong>)ï¼Œ    è€Œ(<strong>&gt;=&gt;</strong>) è¡¨ç¤ºç»“åˆé¡ºåºç›¸åã€‚ </p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">(&lt;=&lt;) :: (<span class="type">Monad</span> m) =&gt; (b -&gt; m c) -&gt; (a -&gt; m b) -&gt; (a -&gt; m c)</span><br><span class="line"><span class="title">f</span> &lt;=&lt; g = (\x -&gt; g x &gt;&gt;= f)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ™®é€šå‡½æ•°ç»“åˆ(.)</span></span><br><span class="line"><span class="title">let</span> f = (+<span class="number">1</span>) . (*<span class="number">100</span>)</span><br><span class="line"><span class="title">f</span> <span class="number">4</span></span><br><span class="line">&gt; <span class="number">401</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆæˆmonadic functions (&lt;=&lt;)</span></span><br><span class="line"><span class="title">let</span> g = (\x -&gt; return (x+<span class="number">1</span>)) &lt;=&lt; (\x -&gt; return (x*<span class="number">100</span>))</span><br><span class="line"><span class="type">Just</span> <span class="number">4</span> &gt;&gt;= g</span><br><span class="line">&gt; <span class="type">Just</span> <span class="number">401</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¹Ÿå¯ä»¥å°† monadic å‡½æ•°ç”¨foldr,id å’Œ(.)åˆæˆ </span></span><br><span class="line"><span class="title">let</span> f = foldr (.) id [(+<span class="number">1</span>),(*<span class="number">100</span>),(+<span class="number">1</span>)]</span><br><span class="line"><span class="title">f</span> <span class="number">1</span></span><br><span class="line">&gt; <span class="number">201</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Monad-çš„-gt-r-å½¢æ€"><a href="#Monad-çš„-gt-r-å½¢æ€" class="headerlink" title="Monad çš„ (-&gt;) r å½¢æ€"></a>Monad çš„ (-&gt;) r å½¢æ€</h2><p><strong>(-&gt;) r</strong> ä¸åªæ˜¯ä¸€ä¸ª <strong>functor</strong> å’Œ <strong>applicative functor</strong>ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ª <strong>monad</strong>ã€‚</p>
<p>æ¯ä¸€ä¸ª <strong>monad</strong> éƒ½æ˜¯ä¸ª <strong>applicative functor</strong>ï¼Œè€Œæ¯ä¸€ä¸ª <strong>applicative functor</strong>ä¹Ÿéƒ½æ˜¯ä¸€ä¸ª <strong>functor</strong>ã€‚å°½ç®¡ <strong>moand</strong> æœ‰ <strong>functor</strong> è·Ÿ <strong>applicative functor</strong> çš„æ€§è´¨ï¼Œä½†ä»–ä»¬ä¸è§å¾—æœ‰ <strong>Functor</strong> è·Ÿ <strong>Applicative</strong> çš„ instance å®šä¹‰ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">instance</span> <span class="type">Monad</span> ((-&gt;) r) <span class="keyword">where</span></span></span><br><span class="line">    return x = \_ -&gt; x</span><br><span class="line">    h &gt;&gt;= f = \w -&gt; f (h w) w</span><br></pre></td></tr></table></figure>

<h2 id="Monad-è¾…åŠ©å‡½æ•°"><a href="#Monad-è¾…åŠ©å‡½æ•°" class="headerlink" title="Monad è¾…åŠ©å‡½æ•°"></a>Monad è¾…åŠ©å‡½æ•°</h2><p>å¸¦ä¸‹åˆ’çº¿å‡½æ•°ç­‰ä»·äºä¸å¸¦ä¸‹åˆ’çº¿çš„å‡½æ•°, åªæ˜¯ä¸è¿”å›å€¼</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">&gt;&gt;= :: m a -&gt; (a -&gt; m b) -&gt; m b</span><br><span class="line">=&lt;&lt; :: (a -&gt; m b) -&gt; m a -&gt; m b</span><br><span class="line"><span class="title">form</span> :: t a -&gt; (a -&gt; m b) -&gt; m (t b)</span><br><span class="line"><span class="title">form_</span> :: t a -&gt; (a -&gt; m b) -&gt; m ()</span><br><span class="line"><span class="title">mapM</span> :: (a -&gt; m b) -&gt; t a -&gt; m (t b)</span><br><span class="line"><span class="title">mapM_</span> :: (a -&gt; m b) -&gt; t a -&gt; m ()</span><br><span class="line"><span class="title">filterM</span> :: (a -&gt; m <span class="type">Bool</span>) -&gt; [a] -&gt; m [a]</span><br><span class="line"><span class="title">foldM</span> :: (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b</span><br><span class="line"><span class="title">sequence</span> :: t (m a) -&gt; m (t a)</span><br><span class="line"><span class="title">sequence_</span> :: t (m a) -&gt; m ()</span><br><span class="line"><span class="title">liftM</span> :: (a1 -&gt; r) -&gt; m a1 -&gt; m r</span><br><span class="line"><span class="title">when</span> :: <span class="type">Bool</span> -&gt; f () -&gt; f ()</span><br><span class="line"><span class="title">join</span> :: m (m a) -&gt; m a</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­åœ¨ IO ä¸­ç»å¸¸ç”¨åˆ°çš„ä¸€äº›å‡½æ•°</p>
<ol>
<li><p><strong>sequence</strong><br><strong>sequence</strong> æ¥å—ä¸€ä¸² I/O actionï¼Œå¹¶å›ä¼ ä¸€ä¸ªä¼šä¾åºæ‰§è¡Œä»–ä»¬çš„ I/O actionã€‚è¿ç®—çš„ç»“æœæ˜¯åŒ…åœ¨ä¸€ä¸ª I/O action çš„ä¸€è¿ä¸² I/O action çš„è¿ç®—ç»“æœã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">main</span> = <span class="keyword">do</span></span><br><span class="line">    a &lt;- getLine</span><br><span class="line">    b &lt;- getLine</span><br><span class="line">    c &lt;- getLine</span><br><span class="line">    print [a,b,c]</span><br></pre></td></tr></table></figure>

<p> å…¶å®å¯ä»¥å†™æˆ</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">main</span> = <span class="keyword">do</span></span><br><span class="line">    rs &lt;- sequence [getLine, getLine, getLine]</span><br><span class="line">    print rs</span><br></pre></td></tr></table></figure>

<p> ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨æ–¹å¼æ˜¯æˆ‘ä»¬å°† <strong>print</strong> æˆ– <strong>putStrLn</strong> ä¹‹ç±»çš„å‡½æ•° map åˆ°ä¸²åˆ—ä¸Šã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">sequence</span> (map print [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">[(),(),(),(),()]</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>mapM</strong> è·Ÿ <strong>mapM_</strong><br>ç”±äºå¯¹ä¸€ä¸ªä¸²åˆ— map ä¸€ä¸ªå›ä¼  I/O action çš„å‡½æ•°ï¼Œç„¶åå† <strong>sequence</strong> è¿™ä¸ªåŠ¨ä½œå¤ªå¸¸ç”¨äº†ã€‚æ‰€ä»¥å‡½å¼åº“ä¸­æä¾›äº† <strong>mapM</strong> è·Ÿ <strong>mapM_</strong>ã€‚<strong>mapM</strong> æ¥å—ä¸€ä¸ªå‡½æ•°è·Ÿä¸€ä¸ªä¸²åˆ—ï¼Œå°†å¯¹ä¸²åˆ—ç”¨å‡½æ•° map ç„¶å sequence ç»“æœã€‚<strong>mapM_</strong> ä¹Ÿä½œåŒæ ·çš„äº‹ï¼Œåªæ˜¯ä»–æŠŠè¿ç®—çš„ç»“æœä¸¢æ‰è€Œå·²ã€‚åœ¨æˆ‘ä»¬ä¸å…³å¿ƒ I/O action ç»“æœçš„æƒ…å†µä¸‹ï¼Œ<strong>mapM_</strong> æ˜¯æœ€å¸¸è¢«ä½¿ç”¨çš„ã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">mapM</span> print [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line">[(),(),()]</span><br><span class="line"></span><br><span class="line"><span class="title">mapM_</span> print [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<p> <strong>form</strong> å’Œ <strong>form_</strong> ä¸ <strong>mapM</strong> å’Œ <strong>mapM_</strong> ç±»ä¼¼ï¼Œä¸è¿‡åªæ˜¯æŠŠåˆ—è¡¨å‚æ•°æå‰ã€‚</p>
</li>
</ol>
<p>è¿˜æœ‰ä¸€äº›æ˜¯åœ¨ <strong>monad</strong> ä¸­å®šä¹‰ï¼Œä¸”ç­‰ä»·äº <strong>functor</strong> æˆ– <strong>applicative functor</strong> ä¸­æ‰€å…·æœ‰çš„å‡½æ•°ã€‚</p>
<ol>
<li><p><strong>liftM</strong><br><strong>liftM</strong> è·Ÿ <strong>fmap</strong> ç­‰ä»·, ä¹Ÿæœ‰ <strong>liftM3</strong>ï¼Œ<strong>liftM4</strong> è·Ÿ <strong>liftM5</strong></p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">liftM</span> :: (<span class="type">Monad</span> m) =&gt; (a -&gt; b) -&gt; m a -&gt; m b</span><br><span class="line"><span class="title">liftM</span> f m = m &gt;&gt;= (\x -&gt; return (f x))</span><br><span class="line"></span><br><span class="line"><span class="title">liftM</span> (*<span class="number">2</span>) [<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">&gt; [<span class="number">2</span>,<span class="number">4</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ap</strong><br><strong>ap</strong> åŸºæœ¬ä¸Šå°±æ˜¯ <strong>&lt;*&gt;</strong>ï¼Œåªæ˜¯ä»–é™åˆ¶åœ¨ Monad ä¸Šè€Œä¸æ˜¯ Applicative ä¸Šã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">ap</span> :: (<span class="type">Monad</span> m) =&gt; m (a -&gt; b) -&gt; m a -&gt; m b</span><br><span class="line"><span class="title">ap</span> mf m = <span class="keyword">do</span></span><br><span class="line">    f &lt;- mf</span><br><span class="line">    x &lt;- m</span><br><span class="line">    return (f x)</span><br><span class="line"></span><br><span class="line"><span class="title">ap</span> [(*<span class="number">2</span>)] [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&gt; [<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>join</strong><br><strong>m &gt;&gt;= f</strong> æ°¸è¿œç­‰ä»·äº <strong>join (fmap f m)</strong> è¿™æ€§è´¨éå¸¸æœ‰ç”¨</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">join</span> :: (<span class="type">Monad</span> m) =&gt; m (m a) -&gt; m a</span><br><span class="line"></span><br><span class="line"><span class="title">join</span> (<span class="type">Just</span> (<span class="type">Just</span> <span class="number">9</span>))</span><br><span class="line">&gt; <span class="type">Just</span> <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="title">join</span> [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]]  <span class="comment">-- å¯¹äº list è€Œè¨€ join ä¸è¿‡å°±æ˜¯ concat</span></span><br><span class="line">&gt; [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>filterM</strong></p>
<p> <strong>filterM</strong>ï¼Œé™¤äº†èƒ½åš filter çš„åŠ¨ä½œï¼ŒåŒæ—¶è¿˜èƒ½ä¿æœ‰ monadic contextã€‚</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">filterM</span> :: (<span class="type">Monad</span> m) =&gt; (a -&gt; m <span class="type">Bool</span>) -&gt; [a] -&gt; m [a]</span><br><span class="line"></span><br><span class="line"><span class="title">filterM</span> (\x -&gt; return (x &gt; <span class="number">2</span>)) [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">&gt; [<span class="number">3</span>,<span class="number">4</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>foldM</strong><br><strong>foldl</strong> çš„ monadic çš„ç‰ˆæœ¬å«åš <strong>foldM</strong></p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">foldM</span> :: (<span class="type">Monad</span> m) =&gt; (a -&gt; b -&gt; m a) -&gt; a -&gt; [b] -&gt; m a</span><br><span class="line"></span><br><span class="line"><span class="title">foldM</span> (\x y -&gt; return (x + y)) <span class="number">0</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&gt; <span class="number">6</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</div>
    	
		<div class="post-footer">
			<div class="tags">
				<i class="icon-tags"></i> 
				
					
					
						
							<a href="/tags/haskell/">haskell</a>
						
					
				
			</div>
			<a class="share" href="javascript:;" data-url="/2018/08/16/haskelld/" data-desc="

ä»€ä¹ˆæ˜¯MonadHaskellæ˜¯ä¸€é—¨çº¯å‡½æ•°å¼çš„è¯­è¨€ï¼Œçº¯å‡½æ•°çš„ä¼˜ç‚¹æ˜¯å®‰å…¨å¯é ã€‚å‡½æ•°è¾“å‡ºå®Œå…¨å–..." data-type="share" title="share"><i class="icon-share"></i></a>
		</div>
	</div>
</article>
</div>
<nav class="pagination clearfix">
  
    
      
        <a href="/2018/12/12/tetris/" class="prev post-prev"> <i class="icon-leftarrow"></i> canvaså®ç°ä¿„ç½—æ–¯æ–¹å—</a>
      

      
        <a href="/2018/08/15/haskellc/" class="next post-next"> Haskellå­¦ä¹ -functor <i class="icon-rightarrow"></i></a>
      
    
  
</nav>

<div class="wxshare-popup">
    <a class="close" href="javascript:;"></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div id="qrcode" class="wx-qrcode"></div>
</div>

    
    <footer class="footer">
<p class="theme">
	Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/edwardzhong/simply.git" target="_blank" rel="noopener">simply</a>
</p>
<p class="copy">Copyright &copy; 2025 Jeff Zhong</p>
</footer>
    <div class="top-bottom">
      <div class="to-top hide" title="to top"><i class="icon-up"></i></div>
      <div class="to-bottom hide" title="to bottom"><i class="icon-down"></i></div>
    </div>
    </div>

  </div>
<input type="hidden" name="isPost" id="isPost" value="true">
<i id="barBtn" class="icon icon-menu"></i>
<div id="payMe" class="payme">
    <i class="icon icon-cancel"></i>
    <p class="pay-title">ç»™æˆ‘çš„æ—©é¤åŠ ä¸ªè›‹å§ ğŸ˜Š</p>
    <div>
      <img src="/images/weixinpay.jpg" alt="weixinpay">
      <img src="/images/alipay.jpg" alt="alipay" style="display:none;">
    </div>
    <div class="pay-selects">
        <input type="radio" name="pay" id="weixinpay" checked="checked"><label for="weixinpay"> å¾®ä¿¡ </label>&nbsp;&nbsp;
        <input type="radio" name="pay" id="alipay"><label for="alipay"> æ”¯ä»˜å® </label>
    </div>
</div>

  
  
    <script src="/lib/jquery-2.2.3.min.js"></script>
  
    <script src="/lib/qrcode.min.js"></script>
  
    <script src="/js/index.js"></script>
  

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</body>
</html>
